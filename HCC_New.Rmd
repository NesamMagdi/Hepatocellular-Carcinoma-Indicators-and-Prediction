---
title: 'Hepatocellular Carcinoma: Indicators and Prediction'
author: "Nesma Magdi"
date: "September 27, 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Greg)
library(dplyr)
library(tidyr)
library(finalfit)
library(ggplot2)
library(moments)
library(e1071)
library(dummies)
library(dplyr)
library(tidyr)
library(finalfit)
library(dummies)
library(moments)
library(corrplot)
library(scatterplot3d)
library(ggplot2)
library(ggplot2)
library(caret)
library(GGally)
library(ggthemes)
library(broom)
library(dplyr)
library(bindrcpp)
library(caTools)
library(rattle)
library(RColorBrewer)
library(nnet)
library(rpart.plot)
library(dichromat)
library(Rmpfr)
library(digest)
library(convertr)
library(microbenchmark)
library(varhandle)
library(hablar)
library(magrittr)
library(survminer)
library(markovchain)
library(survival)
library(expss)
library(AMR)
library(ggpubr)
library(gplots)
```

## Introduction:

Liver cancer is the fifth most common cancer and the second most frequent cause of cancer-related 
death globally. Hepatocellular carcinoma represents about 90% of primary liver cancers and constitutes a major global health problem.
Hepatocellular Carcinoma dataset (HCC dataset) was collected at a University Hospital in Portugal. It contains real clinical data of 165 patients diagnosed with HCC.

# Relevant Information: 

HCC dataset was obtained at a University Hospital in Portugal and contais several demographic, risk factors, laboratory and overall survival features of 165 real patients diagnosed with HCC. The dataset contains 49 features selected according to the EASL-EORTC (European Association for the Study of the Liver - European Organisation for Research and Treatment of Cancer) Clinical Practice Guidelines, which are the current state-of-the-art on the management of HCC.

This is an heterogeneous dataset, with 23 quantitative variables, and 26 qualitative variables. Overall, missing data represents 10.22% of the whole dataset and only eight patients have complete information in all fields (4.85%). The target variables is the survival at 1 year, and was encoded as a binary variable: 0 (dies) and 1 (lives). A certain degree of class-imbalance is also present (63 cases labeled as "dies" and 102 as "lives").


```{r HCC, message=FALSE, warning=FALSE, , warning=FALSE}
ex <- read.csv(choose.files(), header = T)
attach(ex)


HCC_Stages <- c(2, 1, 3, 3, 2, 4, 2, 4, 4, 2, 2, 2, 3, 1, 4, 4, 4, 3, 2, 3,
                1, 2, 3, 3, 4, 3, 3, 2, 3, 2, 3, 2, 1, 1, 1, 3, 4, 3, 2, 3,
                2, NA, 4, 0, 2, 1, 1, 3, 3, 1, 3, 3, 1, 1, 4, 3, 2, 2, 4, 1,
                3, 1, 4, 0, 1, 3, 2, 1, 4, 4, 2, 4, 3, 3, 3, 2, 4, 2, 3, 4, 4,
                NA, 4, 3, 2, NA, 3, NA, 2, 1, 3, 2, 4, 3, 2, 3, 2, 3, 2, 4, 4,
                4, 3, 4, 3, 4, 1, 4, 3, 1, 3, 4, 2, 3, 4, 2, 3, 4, 1, 1, 3, 1,
                3, 2, 3, 4, 2, 4, 3, 4, 3, 4, 2, 3, 2, 3, NA, 1, 1, 3, 3, 2, 1,
                1, 2, 1, 3, 1, 2, 3, 1, 2, 3, 4, 2, 4, 3, 2, 2, 4, 1, 3, 3, 3, 4, rep(NA, 39))
ex <- cbind(ex, HCC_Stages)

# Rename:

ex$Gender<-as.factor(ex$Gender)
ex$Symptoms<-as.factor(ex$Symptoms)
ex$Alcohol<-as.factor(ex$Alcohol)
ex$HBsAg<-as.factor(ex$HBsAg)
ex$HBeAg<-as.factor(ex$HBeAg)
ex$HBcAb<-as.factor(ex$HBcAb)
ex$HCVAb<-as.factor(ex$HCVAb)
ex$Cirrhosis<-as.factor(ex$Cirrhosis)
ex$Endemic<-as.factor(ex$Endemic)
ex$Smoking<-as.factor(ex$Smoking)
ex$Diabetes<-as.factor(ex$Diabetes)
ex$Obesity<-as.factor(ex$Obesity)
ex$Hemochro<-as.factor(ex$Hemochro)
ex$AHT<-as.factor(ex$AHT)
ex$CRI<-as.factor(ex$CRI)
ex$HIV<-as.factor(ex$HIV)
ex$NASH<-as.factor(ex$NASH)
ex$Varices<-as.factor(ex$Varices)
ex$Spleno<-as.factor(ex$Spleno)
ex$PHT<-as.factor(ex$PHT)
ex$PVT<-as.factor(ex$PVT)
ex$Metastasis<-as.factor(ex$Metastasis)
ex$Hallmark<-as.factor(ex$Hallmark)
ex$PS<-as.factor(ex$PS)
ex$Encephalopathy<-as.factor(ex$Encephalopathy)
ex$Ascites<-as.factor(ex$Ascites)
ex$Class <- as.factor(ex$Class)
ex$HCC_Stages <- as.factor(ex$HCC_Stages)


levels(ex$Gender)[levels(ex$Gender)==0] <- "Female"
levels(ex$Gender)[levels(ex$Gender)==1]  <- "Male"

levels(ex$Symptoms)[levels(ex$Symptoms)==0] <- "No Symptoms"
levels(ex$Symptoms)[levels(ex$Symptoms)==1]  <- "Symptoms"

levels(ex$Alcohol)[levels(ex$Alcohol)==0] <- "Not Alcoholic"
levels(ex$Alcohol)[levels(ex$Alcohol)==1]  <- "Alcoholic"

levels(ex$HBsAg)[levels(ex$HBsAg)==0] <- "Negative"
levels(ex$HBsAg)[levels(ex$HBsAg)==1]  <- "Positive"

levels(ex$HBeAg)[levels(ex$HBeAg)==0] <- "Negative"
levels(ex$HBeAg)[levels(ex$HBeAg)==1]  <- "Positive"

levels(ex$HBcAb)[levels(ex$HBcAb)==0] <- "Negative"
levels(ex$HBcAb)[levels(ex$HBcAb)==1]  <- "Positive"

levels(ex$HCVAb)[levels(ex$HCVAb)==0] <- "Negative"
levels(ex$HCVAb)[levels(ex$HCVAb)==1]  <- "Positive"

levels(ex$Cirrhosis)[levels(ex$Cirrhosis)==0] <- "Absent"
levels(ex$Cirrhosis)[levels(ex$Cirrhosis)==1]  <- "Present"

levels(ex$Endemic)[levels(ex$Endemic)==0] <- "No"
levels(ex$Endemic)[levels(ex$Endemic)==1]  <- "Yes"

levels(ex$Smoking)[levels(ex$Smoking)==0] <- "Non Smoker"
levels(ex$Smoking)[levels(ex$Smoking)==1]  <- "Smoker"

levels(ex$Diabetes)[levels(ex$Diabetes)==0] <- "Normal"
levels(ex$Diabetes)[levels(ex$Diabetes)==1]  <- "Diabetic"

levels(ex$Obesity)[levels(ex$Obesity)==0] <- "Not Obese"
levels(ex$Obesity)[levels(ex$Obesity)==1]  <- "Obese"

levels(ex$Hemochro)[levels(ex$Hemochro)==0] <- "Absent"
levels(ex$Hemochro)[levels(ex$Hemochro)==1]  <- "Present"

levels(ex$AHT)[levels(ex$AHT)==0] <- "Absent"
levels(ex$AHT)[levels(ex$AHT)==1]  <- "Present"

levels(ex$CRI)[levels(ex$CRI)==0] <- "Absent"
levels(ex$CRI)[levels(ex$CRI)==1]  <- "Present"

levels(ex$HIV)[levels(ex$HIV)==0] <- "Negative"
levels(ex$HIV)[levels(ex$HIV)==1]  <- "Positive"

levels(ex$NASH)[levels(ex$NASH)==0] <- "Absent"
levels(ex$NASH)[levels(ex$NASH)==1]  <- "Present"

levels(ex$Varices)[levels(ex$Varices)==0] <- "Absent"
levels(ex$Varices)[levels(ex$Varices)==1]  <- "Present"

levels(ex$Spleno)[levels(ex$Spleno)==0] <- "Absent"
levels(ex$Spleno)[levels(ex$Spleno)==1]  <- "Present"

levels(ex$PHT)[levels(ex$PHT)==0] <- "Absent"
levels(ex$PHT)[levels(ex$PHT)==1]  <- "Present"

levels(ex$PVT)[levels(ex$PVT)==0] <- "Absent"
levels(ex$PVT)[levels(ex$PVT)==1]  <- "Present"

levels(ex$Metastasis)[levels(ex$Metastasis)==0] <- "Absent"
levels(ex$Metastasis)[levels(ex$Metastasis)==1]  <- "Present"

levels(ex$Hallmark)[levels(ex$Hallmark)==0] <- "Absent"
levels(ex$Hallmark)[levels(ex$Hallmark)==1]  <- "Present"

colnames(ex)[25]<-"Alcohol Assumption"
colnames(ex)[26]<-"Cigarette Assumption"

levels(ex$PS)[levels(ex$PS)==0] <- "Active"
levels(ex$PS)[levels(ex$PS)==1]  <- "Restricted"
levels(ex$PS)[levels(ex$PS)==2]  <- "Ambulatory"
levels(ex$PS)[levels(ex$PS)==3]  <- "Selfcare"
levels(ex$PS)[levels(ex$PS)==4]  <- "Disabled"

levels(ex$Encephalopathy)[levels(ex$Encephalopathy)==1]  <- "None"
levels(ex$Encephalopathy)[levels(ex$Encephalopathy)==2]  <- "Grade I/II"
levels(ex$Encephalopathy)[levels(ex$Encephalopathy)==3]  <- "Grade III/IV"

levels(ex$Ascites)[levels(ex$Ascites)==1]  <- "None"
levels(ex$Ascites)[levels(ex$Ascites)==2]  <- "Mild"
levels(ex$Ascites)[levels(ex$Ascites)==3]  <- "Moderate to Sever"

levels(ex$HCC_Stages)[levels(ex$HCC_Stages)==0]  <- "Very early stage"
levels(ex$HCC_Stages)[levels(ex$HCC_Stages)==1]  <- "Early stage (A)"
levels(ex$HCC_Stages)[levels(ex$HCC_Stages)==2]  <- "Intermediate stage (B)"
levels(ex$HCC_Stages)[levels(ex$HCC_Stages)==3]  <- "Advanced stage (C)"
levels(ex$HCC_Stages)[levels(ex$HCC_Stages)==4]  <- "Terminal stage (D)"

colnames(ex)[50]<-"Status"

levels(ex$Status)[levels(ex$Status)==0] <- "Dies"
levels(ex$Status)[levels(ex$Status)==1]  <- "Lives"

ex <-mutate(ex, dummy_Age = ifelse(Age > 50 ,"Age >50","Age <50"))
ex <-mutate(ex, dummy_Dim = ifelse(Major_Dim > 1 ,"Nodule Dim >1","Nodule Dim <1"))

+ BSA + SBP + DBP + MAP + CWI + LVMI + IVST + LVPWD + E.WAVE + A.WAVE+ E.A

attach(lung)
Time <- lung[1:204, 2]

ex <- cbind(ex, Time)

ex <- ex[ ,c(50, 24, 51, 52, 1, 9, 2, 54, 27, 3, 25, 10, 26, 11, 12, 
       30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 46, 47,
       49, 4, 5, 6, 7, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
       28, 29, 48, 44, 45, 53)]


write.csv(ex, file="HCC.csv")
HCC <- read.csv(choose.files(), header = T)
attach(HCC)

Original <- read.csv(choose.files(), header = T)
Original <- cbind(Original, HCC_Stages, Time)
write.csv(Original, file="Original.csv")
attach(Original)

```

## Analysis of Observations:

```{r warning=FALSE, , echo=TRUE}
summary(HCC)

```

## Dependent Variable: 
Status, Symptoms, Performance Status

#1- Status: 
  Live Patients = 102 (50%), Died Patients: 102(50%), By the End of the Trial After 1 Year.
  
```{r warning=FALSE, , echo=TRUE}
ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  theme_economist() 

X <- table(Status)
prop.table(X)*100

```

#2- Symptoms: 
  141 (69.11%) of Patients Symptomatic, 63 (30.88%) Patients Asymptomatic.
  
```{r warning=FALSE, , echo=TRUE}
ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  theme_economist() 

X1 <- table(HCC$Symptoms)
prop.table(X1)*100
```  

#3- Performance Status:
  88 (43.14%) of Patients is Active, 37 (18.14%) needs Ambulatory care, 6 (29.41%) disabled, 44 (21.57%) Restricted and 29 (14.22%) needs selfcare.

```{r warning=FALSE, , echo=TRUE}
ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  theme_economist()  

X2 <- table(HCC$PS)
prop.table(X2)*100
```

#4- HCC Stages:
  29 (18.13%) of Patients in Early Stage (A), 39 (24.38%) in Intermediate Stage (B), 53 (33.13%) in Advanced Stage (C), 37 (23.13%) in Terminal Stage and 2 (1.25%) in Very Early Stage.

```{r warning=FALSE, , echo=TRUE}
ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  theme_economist()  

X3 <- table(HCC$HCC_Stages)
prop.table(X3)*100
```

#Summary:

```{r warning=FALSE, , echo=TRUE}
HCC %>%
  freq(Status, Symptoms, PS, HCC_Stages)

```

## First, Demographic Data:

## Independent Variables: 
Age, Gender, Endemic.

#1- Relation Between Age of Patients and Dependent Variables:

```{r warning=FALSE, , echo=TRUE}
Age_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Age, na.rm = T), sd = sd(Age, na.rm = T)))
Age_mean

Age_table1 <- table(dummy_Age)
Age_table1
prop.table(Age_table1)*100

ggplot(HCC, aes(x=Age)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

skewness(Age)
kurtosis(Age)

shapiro.test(Age)

```

  Mean age of population of Intrest is 65.5 and standard Deviation is 12.78.
  The Distribution is moderatley Skewed, and Kurtosis is in acceptable range for bing normally distributed.

From the output, the p-values= 1.294e-05 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- Age with Status:

```{r warning=FALSE, , echo=TRUE}

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Age, na.rm = TRUE),
    sd = sd(Age, na.rm = TRUE)
  )


ggplot(data = HCC, aes(x = Status, y = Age, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Age", fill = "Status") +
  ggtitle("Relation Between Different Status of Patients and Age") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
   facet_grid(~ dummy_Age) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

Age_table <- table(dummy_Age, Status)
Age_table
prop.table(Age_table)*100

# Shapiro-Wilk normality test for Age of Lived group:
with(HCC, shapiro.test(Age[Status == "Lives"]))
# Shapiro-Wilk normality test for Age of Died group:
with(HCC, shapiro.test(Age[Status == "Dies"]))

ggboxplot(HCC, x = "Status", y = "Age", 
          color = "Status",
        ylab = "Age", xlab = "Status") +
   theme_economist()

wilcox.test(Age ~ Status, mu=0, alternative = "two.sided", paired = FALSE)
```

  From the output, the two p-values are less than the significance level 0.05 implying that the distribution of the data are significantly different from the normal distribution. In other words, we cannot assume the normality.
  
  The p-value of the Wilcoxon rank sum test is 0.004744, which is less than the significance level alpha = 0.05. We can conclude that Live patient average ages is significantly different from Died patients average ages with a p-value = 0.0047.
  
**B- Age with Symptoms:
    
```{r warning=FALSE, , echo=TRUE}

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Age, na.rm = TRUE),
    sd = sd(Age, na.rm = TRUE)
  )


ggplot(data = HCC, aes(x = Symptoms, y = Age, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Age", fill = "Symptoms") +
  ggtitle("Relation Between Symptoms appearance and Age") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
   facet_grid(~ dummy_Age) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

Age_table3 <- table(dummy_Age, HCC$Symptoms)
Age_table3
prop.table(Age_table3)*100


ggboxplot(HCC, x = "Symptoms", y = "Age", 
          color = "Symptoms",
        ylab = "Age", xlab = "Symptoms") +
   theme_economist()

# Shapiro-Wilk normality test for Age of Symptomatic group:
with(HCC, shapiro.test(Age[Symptoms == "Symptoms"]))
# Shapiro-Wilk normality test for Age of Asymptomatic group:
with(HCC, shapiro.test(Age[Symptoms == "No Symptoms"]))

  wilcox.test(Age ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

  The p-value of the Wilcoxon rank sum test is 0.9928, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average ages is not significantly different from Asymptomatic patients average ages.
  
**C- Age with Performance Status:

```{r warning=FALSE, , echo=TRUE}

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Age, na.rm = TRUE),
    sd = sd(Age, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Age, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Age", fill = "PS") +
  ggtitle("Relation Between Performance Status and Age") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
   facet_grid(~ dummy_Age) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


Age_table4 <- table(dummy_Age, HCC$PS)
Age_table4
prop.table(Age_table4)*100

ggboxplot(HCC, x = "PS", y = "Age", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Age", xlab = "PS") +
  theme_economist()


Age_PS_anova <- (aov(formula = Age ~ PS, data = HCC))
summary(Age_PS_anova)


kruskal.test(formula = Age ~ PS, data = HCC)

```

In one-way ANOVA test, a significant p-value = 0.11 indicates that no different in the group means.  
In Kruskal-Wallis rank sum test, the p-value = 0.1095 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Age with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Age, na.rm = TRUE),
    sd = sd(Age, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Age, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC Stages", y = "Age", fill = "HCC_Stages") +
  ggtitle("Relation Between HCC Stages and Age") +
  scale_fill_discrete(name = "HCC Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
   facet_grid(~ dummy_Age) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

Age_table5 <- table(dummy_Age, HCC$HCC_Stages)
Age_table5
prop.table(Age_table5)*100

ggboxplot(HCC, x = "HCC_Stages", y = "Age", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Age", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Age_HCC_anova <- (aov(formula = Age ~ HCC_Stages, data = HCC))
summary(Age_HCC_anova)

kruskal.test(formula = Age ~ HCC_Stages, data = HCC)
```

In one-way ANOVA test, a significant p-value = 0.451 indicates that no different in the group means.

In Kruskal-Wallis rank sum test, the p-value = 0.5048 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#2- Relation Between Gender of Patients and Dependent Variables:

```{r warning=FALSE, , echo=TRUE}


Gender_sd <- as.data.frame(HCC %>%
             summarise(count = n(), sd = sd(Gender, na.rm = T))) 

Gender_sd

Count_Gender <- table(HCC$Gender)
Percent_Gender <- prop.table(Count_Gender)*100

Gender_persent <- as.data.frame(cbind(Count_Gender, Percent_Gender))
Gender_persent


ggplot(HCC,aes(Gender, fill= Gender)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Gender)

```

  SD of the Gender population of Intrest is 0.405.

The p-value of the Chi.Square test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Gender of patients are significantly commonly distributed with a p-value = 1.

**A- Gender with Status:
  
```{r warning=FALSE, , echo=TRUE}

Gender_status <- as.data.frame(HCC %>%
            summary_factorlist("Status", "Gender", add_dependent_label = T,   cont_cut = 1))
Gender_status 

Count_Gender1 <- table(HCC$Gender, HCC$Status)
Percent_Gender1 <- prop.table(Count_Gender1)*100

Gender_persent1 <- as.data.frame(cbind(Count_Gender1, Percent_Gender1))
Gender_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Gender, ncol=2,scale="fixed") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCC$Gender,HCC$Status)

```

 p-value of chi.square is 1 > 0.05. So, this means there is no evidence to suggest that men and women tend to have difference in Status.
 
**B- Gender with Symptoms:
    
```{r warning=FALSE, , echo=TRUE}
Gender_symptoms <- as.data.frame(HCC %>%
                summary_factorlist("Symptoms", "Gender", add_dependent_label = T,
                                                    cont_cut = 1))

Count_Gender2 <- table(HCC$Gender, HCC$Symptoms)
Percent_Gender2 <- prop.table(Count_Gender2)*100

Gender_persent2 <- as.data.frame(cbind(Count_Gender2, Percent_Gender2))
Gender_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Gender, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCC$Gender,HCC$Symptoms)

```

 p-value of chi.square is 0.5665 > 0.05. So, this means there is no evidence to suggest that men and women tend to have difference in Symptoms Appearance.
 
**C- Gender with Performance Status:
    
```{r warning=FALSE, , echo=TRUE}

Gender_PS <- as.data.frame(HCC %>%
                                   summary_factorlist("PS", "Gender", add_dependent_label = T,
                                                      cont_cut = 1))
Gender_PS

Count_Gender3 <- table(HCC$Gender, HCC$PS)
Percent_Gender3 <- prop.table(Count_Gender3)*100

Gender_persent3 <- as.data.frame(cbind(Count_Gender3, Percent_Gender3))
Gender_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Gender, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCC$Gender,HCC$PS)
```

   p-value of chi.square is 0.1852 > 0.05. So, this means there is no evidence to suggest that men and women tend to have difference in Performane Status.

**D- Gender with HCC Stage:
    
```{r warning=FALSE, , echo=TRUE}
Gender_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Gender", add_dependent_label = T, cont_cut = 1))
Gender_Stages 

Count_Gender4 <- table(HCC$Gender, HCC$HCC_Stages)
Percent_Gender4 <- prop.table(Count_Gender4)*100

Gender_persent4 <- as.data.frame(cbind(Count_Gender4, Percent_Gender4))
Gender_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Gender, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCC$Gender,HCC$HCC_Stages) 
```

  p-value of chi.square is 0.9322 > 0.05. So, this means there is no evidence to suggest that men and women tend to have difference in HCC Stages.
  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#3- Relation Between Presence of Patients in Endemic Countries and Dependent Variables:
   
```{r warning=FALSE, , echo=TRUE}
Endemic_mean <- as.data.frame(HCC %>%
                 summarise(count = n(), sd = sd(Endemic, na.rm = T)))
Endemic_mean

Count_Endemic <- table(HCC$Endemic)
Percent_Endemic <- prop.table(Count_Endemic)*100

Endemic_persent <- as.data.frame(cbind(Count_Endemic, Percent_Endemic))
Endemic_persent

ggplot(HCC,aes(Endemic, fill= Endemic)) +
  geom_bar(stat="count") +
  theme_economist()


chisq.test(Endemic)
```

  SD of the population of Interest lives in endemic countries is 0.24.

  chi.square test of normality shows p-value = 0.6995 > 0.05, Which means sample lives in endemic countries is Not normally disributed.
  The p-value of the test is 0.6995, which is greater than the significance level alpha = 0.05. We can conclude that Presence of Patients in Endemic Countries are significantly commonly distributed with a p-value = 0.6995.
  
**A- Endemic with Status:
    
```{r warning=FALSE, , echo=TRUE}
Endemic_status <- as.data.frame(HCC %>%
             summary_factorlist("Status", "Endemic", add_dependent_label = T, cont_cut = 1))
Endemic_status 

Count_Endemic1 <- table(HCC$Endemic, HCC$Status)
Percent_Endemic1 <- prop.table(Count_Endemic1)*100

Endemic_persent1 <- as.data.frame(cbind(Count_Endemic1, Percent_Endemic1))
Endemic_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Endemic, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Endemic, Status) 
```

  chi.square test shows p-value = 0.037 < 0.05, It provides strong evidence to suggest that Presence of Patients in Endemic Countrie tend to have difference in Status of Patients.
    
**B- Endemic with Symptoms:
    
```{r warning=FALSE, , echo=TRUE}
Endemic_symptoms <- as.data.frame(HCC %>%
                                  summary_factorlist("Symptoms", "Endemic", add_dependent_label = T, cont_cut = 1))

Endemic_symptoms

Count_Endemic2 <- table(HCC$Endemic, HCC$Symptoms)
Percent_Endemic2 <- prop.table(Count_Endemic2)*100

Endemic_persent2 <- as.data.frame(cbind(Count_Endemic2, Percent_Endemic2))
Endemic_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Endemic, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Endemic, Symptoms) 
```

  chi.square test shows p-value = 0.8945 > 0.05, So, this means there is no evidence to suggest that Presence of Patients in Endemic Countrie tend to have difference in Symptoms Apearance.
  
**C- Endemic with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Endemic_PS <- as.data.frame(HCC %>%
                summary_factorlist("PS", "Endemic", add_dependent_label = T,  cont_cut = 1))
Endemic_PS

Count_Endemic3 <- table(HCC$Endemic, HCC$PS)
Percent_Endemic3 <- prop.table(Count_Endemic3)*100

Endemic_persent3 <- as.data.frame(cbind(Count_Endemic3, Percent_Endemic3))
Endemic_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Endemic, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Endemic, PS) 
```

  chi.square test shows p-value = 0.2963 > 0.05, So, this means there is no evidence to suggest that Presence of Patients in Endemic Countrie tend to have difference in Performance Status.

**D- Endemic with HCC Stage:

```{r warning=FALSE, , echo=TRUE}
Endemic_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Endemic", add_dependent_label = T, cont_cut = 1))
Endemic_Stages

Count_Endemic4 <- table(HCC$Endemic, HCC$HCC_Stages)
Percent_Endemic4 <- prop.table(Count_Endemic4)*100

Endemic_persent4 <- as.data.frame(cbind(Count_Endemic4, Percent_Endemic4))
Endemic_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Endemic, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Endemic, HCC_Stages) 
```

  chi.square test shows p-value = 0.0602 > 0.05, So, this means there is no evidence to suggest that Presence of Patients in Endemic Countrie tend to have difference in HCC Stages.
  
## Summaries The Demographic Data:

```{r warning=FALSE, , echo=TRUE}

as.data.frame(cro_cpct(HCC$Gender, list(total(), HCC$dummy_Age, HCC$Endemic)))


as.data.frame(HCC %>% 
  tab_cells(Age, Gender, Endemic) %>%
  tab_cols(total(), Status) %>% 
  tab_stat_mean_sd_n() %>%
  tab_last_sig_means(subtable_marks = "both") %>% 
  tab_pivot() %>% 
  set_caption("Table with summary statistics and significance marks"))

```

**********************************************************************************************************************************************************************************************************************************************

## Second: Analysis of Risk Factors:

#Dependent Variable: 
Status, Symptoms, Performance Status, HCC Stages.

#Independent Variables: 
Alcohol, Alcohol Assumption, Smoking, Cigarette Assumption, Diabetes, Obesity.
  
#1- Relation Between Alcoholic Patients and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

  Alcohol_sd <- as.data.frame(HCC %>%
           summarise(count = n(), sd = sd(Alcohol, na.rm = T)))

Alcohol_sd

Count_Alcohol <- table(HCC$Alcohol)
Percent_Alcohol <- prop.table(Count_Alcohol)*100

Alcohol_persent <- as.data.frame(cbind(Count_Alcohol, Percent_Alcohol))
Alcohol_persent

ggplot(HCC,aes(Alcohol, fill= Alcohol)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Alcohol)
```

 Number of Alcoholic Patients is 147 (72.06%), Number of Non Alcoholic Patients is 57 (27.94%)
 SD of the Alcoholic population of Intrest is 0.45.

The p-value of the Chi.Square test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Alcohol consumption status of patients are significantly commonly distributed with a p-value = 1.

**A- Alcohol Intake with Status:

```{r warning=FALSE, , echo=TRUE}

Alcohol_status <- as.data.frame(HCC %>%
                              summary_factorlist("Status", "Alcohol", add_dependent_label = T,
                                                 cont_cut = 1))
Alcohol_status

Count_Alcohol1 <- table(HCC$Alcohol, HCC$Status)
Percent_Alcohol1 <- prop.table(Count_Alcohol1)*100

Alcohol_persent1 <- as.data.frame(cbind(Count_Alcohol1, Percent_Alcohol1))
Alcohol_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Alcohol, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Alcohol, Status) 
```

 chi.square test shows p-value = 1 > 0.05, So, this means there is no evidence to suggest that Alcohol consumption status of patients tend to cause difference in Status.

**B- Alcohol Intake with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Alcohol_symptoms <- as.data.frame(HCC %>%
                 summary_factorlist("Symptoms", "Alcohol", add_dependent_label = T, cont_cut = 1))
Alcohol_symptoms

Count_Alcohol2 <- table(HCC$Alcohol, HCC$Symptoms)
Percent_Alcohol2 <- prop.table(Count_Alcohol2)*100

Alcohol_persent2 <- as.data.frame(cbind(Count_Alcohol2, Percent_Alcohol2))
Alcohol_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Alcohol, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Alcohol, Symptoms) 
```

 chi.square test shows p-value = 0.7095 > 0.05, So, this means there is no evidence to suggest that Alcohol consumption status of patients tend to cause difference in Symptoms Appearance.
 
**C- Alcohol Intake with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Alcohol_PS <- as.data.frame(HCC %>%
               summary_factorlist("PS", "Alcohol", add_dependent_label = T, cont_cut = 1))
Alcohol_PS

Count_Alcohol3 <- table(HCC$Alcohol, HCC$PS)
Percent_Alcohol3 <- prop.table(Count_Alcohol3)*100

Alcohol_persent3 <- as.data.frame(cbind(Count_Alcohol3, Percent_Alcohol3))
Alcohol_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Alcohol, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Alcohol, PS) 
```

  chi.square test shows p-value = 0.01183 < 0.05, So, It provides strong evidence to suggest that Alcohol consumption status of patients tend to cause difference in Performance Status.
  
**D- Alcohol Intake with HCC Stage:

```{r warning=FALSE, , echo=TRUE}
Alcohol_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Alcohol", add_dependent_label = T, cont_cut = 1))
Alcohol_Stages

Count_Alcohol4 <- table(HCC$Alcohol, HCC$HCC_Stages)
Percent_Alcohol4 <- prop.table(Count_Alcohol4)*100

Alcohol_persent4 <- as.data.frame(cbind(Count_Alcohol4, Percent_Alcohol4))
Alcohol_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Alcohol, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Alcohol, HCC_Stages)  
```

  chi.square test shows p-value = 0.02434 < 0.05, So, It provides strong evidence to suggest that Alcohol consumption status of patients tend to cause difference in HCC Stages.
  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#2- Relation Between Grams of Alcohol Assumption Per day and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Alcohol_Assum_mean <- as.data.frame(HCC %>%
                summarise(count = n(), mean = mean(Alcohol.Assumption, na.rm = T),  sd = sd(Alcohol.Assumption, na.rm = T)))
Alcohol_Assum_mean

hist(Alcohol.Assumption)

ggplot(HCC, aes(x=Alcohol.Assumption)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

boxplot(Alcohol.Assumption)

shapiro.test(Alcohol.Assumption)


```

 Mean of Grams of Alcohol Assumption Per day 75.29 and SD is 63.18.

From the output, the p-values= 2.413e-15 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- Alcohol Assumption with Status:
    
```{r warning=FALSE, , echo=TRUE}

Alcohol_Assum_status <- as.data.frame(HCC %>%
              summary_factorlist("Status", "Alcohol.Assumption", add_dependent_label = T, cont_cut = 1))
Alcohol_Assum_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Alcohol.Assumption, na.rm = TRUE),
    sd = sd(Alcohol.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = Alcohol.Assumption, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Alcohol.Assumption", fill = "Status") +
  ggtitle("Relation Between Alcohol Assumption Per day and Status") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Alcohol.Assumption", 
          color = "Status",
        ylab = "Alcohol.Assumption", xlab = "Status") +
   theme_economist()

  wilcox.test(Alcohol.Assumption ~ Status, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.536, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average Alcohol Assumption is not significantly different from Died patients average Alcohol Assumption with a p-value = 0.536.
 
**B- Alcohol Assumption with Symptoms:
    
```{r warning=FALSE, , echo=TRUE}

Alcohol_Assum_symptoms <- as.data.frame(HCC %>%
                                   summary_factorlist("Symptoms", "Alcohol.Assumption", add_dependent_label = T, cont_cut = 1))
Alcohol_Assum_symptoms 

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Alcohol.Assumption, na.rm = TRUE),
    sd = sd(Alcohol.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Alcohol.Assumption, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Alcohol.Assumption", fill = "Status") +
  ggtitle("Relation Between Alcohol Assumption Per day and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Alcohol.Assumption", 
          color = "Status",
        ylab = "Alcohol.Assumption", xlab = "Status") +
   theme_economist()

  wilcox.test(Alcohol.Assumption ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.9003, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patients average Alcohol Assumption is not significantly different from Asymptomatic patients average Alcohol Assumption with a p-value = 0.9003.
 
**C- Alcohol Assumption with Performance Status:
    
```{r warning=FALSE, , echo=TRUE}

Alcohol_Assum_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Alcohol.Assumption", add_dependent_label = T,  cont_cut = 1))

Alcohol_Assum_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Alcohol.Assumption, na.rm = TRUE),
    sd = sd(Alcohol.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Alcohol.Assumption, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Alcohol.Assumption", fill = "PS") +
  ggtitle("Relation Between Alcohol Assumption Per day and Performance Status") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "PS", y = "Alcohol.Assumption", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Alcohol.Assumption", xlab = "PS") +
  theme_economist()


Alcohol_Assum_PS_anova <- (aov(formula = Alcohol.Assumption ~ PS, data = HCC))
summary(Alcohol_Assum_PS_anova)

kruskal.test(formula = Alcohol.Assumption ~ PS, data = HCC)

```

 In one-way ANOVA test, a significant p-value = 0.962 indicates that no different in the group means.  
 In Kruskal-Wallis rank sum test, the p-value = 0.961 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Alcohol Assumption with HCC Stages:
    
```{r warning=FALSE, , echo=TRUE}

Alcohol_Assum_Stage <- as.data.frame(HCC %>%
                 summary_factorlist("HCC_Stages", "Alcohol.Assumption", add_dependent_label = T,  cont_cut = 1))

Alcohol_Assum_Stage

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Alcohol.Assumption, na.rm = TRUE),
    sd = sd(Alcohol.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Alcohol.Assumption, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Alcohol.Assumption", fill = "HCC_Stages") +
  ggtitle("Relation Between Alcohol Assumption Per day and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "HCC_Stages", y = "Alcohol.Assumption", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Alcohol.Assumption", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Alcohol_Assum_Stage_anova <- (aov(formula = Alcohol.Assumption ~ HCC_Stages, data = HCC))
summary(Alcohol_Assum_Stage_anova)

kruskal.test(formula = Alcohol.Assumption ~ HCC_Stages, data = HCC)

```
 
 In one-way ANOVA test, a significant p-value = 0.167 indicates that no different in the group means.  
 In Kruskal-Wallis rank sum test, the p-value = 0.507 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#3- Relation Between Smoking and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Smoking_mean <- as.data.frame(HCC %>%
             summarise(count = n(), sd = sd(Smoking, na.rm = T)))
Smoking_mean

Count_Smoking <- table(HCC$Smoking)
Percent_Smoking <- prop.table(Count_Smoking)*100

Smoking_persent <- as.data.frame(cbind(Count_Smoking, Percent_Smoking))
Smoking_persent

ggplot(HCC,aes(Smoking, fill= Smoking)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Smoking)
```

  SD of the Smoking population of Intrest is 0.499.
  Total Number of Smoker patients is 92 (45.098%) and Non Smoker is 112 (54.9%).

The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Smpking Status of patients are significantly commonly distributed with a p-value = 1.

**A- Smoking with Status:

```{r warning=FALSE, , echo=TRUE}

Smoking_status <- as.data.frame(HCC %>%
                summary_factorlist("Status", "Smoking", add_dependent_label = T, cont_cut = 1))
Smoking_status 

Count_Smoking1 <- table(HCC$Smoking, HCC$Status)
Percent_Smoking1 <- prop.table(Count_Smoking1)*100

Smoking_persent1 <- as.data.frame(cbind(Count_Smoking1, Percent_Smoking1))
Smoking_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Smoking, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Smoking, Status) 
```
    
 From Smoker Patients, 40 (19.61%) Dies and 52 (25.49%) Lives
 Non Smoker Patients, 62 (30.39%) Dies and 50 (24.51%) Lives.

 p-value of chi.square is 0.1217 > 0.05. So, this means there is no evidence to suggest that Smoking Status tend to cause difference in Status.
 
**B- Smoking with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Smoking_symptoms <- as.data.frame(HCC %>%
                                    summary_factorlist("Symptoms", "Smoking", add_dependent_label = T, cont_cut = 1))
Smoking_symptoms

Count_Smoking2 <- table(HCC$Smoking, HCC$Symptoms)
Percent_Smoking2 <- prop.table(Count_Smoking2)*100

Smoking_persent2 <- as.data.frame(cbind(Count_Smoking2, Percent_Smoking2))
Smoking_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Smoking, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Smoking, Symptoms) 
```

 p-value of chi.square is 0.7403 > 0.05. So, this means there is no evidence to suggest that Smoking Status tend to cause difference in Symptoms Appearance.
 
**C- Smoking with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Smoking_PS <- as.data.frame(HCC %>%
                              summary_factorlist("PS", "Smoking", add_dependent_label = T, cont_cut = 1))
Smoking_PS

Count_Smoking3 <- table(HCC$Smoking, HCC$PS)
Percent_Smoking3 <- prop.table(Count_Smoking3)*100

Smoking_persent3 <- as.data.frame(cbind(Count_Smoking3, Percent_Smoking3))
Smoking_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Smoking, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Smoking, PS) 
```
    
  Smoker Patients, 41 (20.098%) Active, 18 (8.82%) needs Ambulatory care, 2 (1.96%) Disabled, 20 (9.8%) Restricted and 9 (4.41%) needs Selfcare.
  Non Smoker Patients, 47 (23.04%) Active, 19 (9.31%) needs Ambulatory care, 4 (0.98%) Disabled, 24 (11.76%) Restricted and 20 (9.8%) needs Selfcare. 
  
 p-value of chi.square is 0.4461 > 0.05. So, this means there is no evidence to suggest that Smoking Status tend to cause difference in Performance Status.
 
**D- Smoking with HCC Stage:

```{r warning=FALSE, , echo=TRUE}
Smoking_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Smoking", add_dependent_label = T, cont_cut = 1))
Smoking_Stages

Count_Smoking4 <- table(HCC$Smoking, HCC$HCC_Stages)
Percent_Smoking4 <- prop.table(Count_Smoking4)*100

Smoking_persent4 <- as.data.frame(cbind(Count_Smoking4, Percent_Smoking4))
Smoking_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Smoking, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Smoking, HCC_Stages) 
```

 p-value of chi.square is 0.4071 > 0.05. So, this means there is no evidence to suggest that Smoking Status tend to cause difference in Performance Status.  
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#4- Relation Between Assumped Packs of Cigarettes per Year and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Cigar_Assum_mean <- as.data.frame(HCC %>%
                     summarise(count = n(), mean = mean(Cigarette.Assumption, na.rm = T),  sd = sd(Cigarette.Assumption, na.rm = T)))
Cigar_Assum_mean

hist(Cigarette.Assumption)

ggplot(HCC, aes(x=Cigarette.Assumption)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

boxplot(Cigarette.Assumption)

shapiro.test(Cigarette.Assumption)

```

 Mean of Assumped Packs of Cigarettes per Year 21.4 and SD is 44.18.
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- Cigarettes Assumption with Status:
    
```{r warning=FALSE, , echo=TRUE}

Cigar_Assum_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Cigarette.Assumption", add_dependent_label = T,
                                                           cont_cut = 1))
Cigar_Assum_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Cigarette.Assumption, na.rm = TRUE),
    sd = sd(Cigarette.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = Cigarette.Assumption, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Cigarette.Assumption", fill = "Status") +
  ggtitle("Relation Between Assumped Packs of Cigarettes per Year and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Cigarette.Assumption", 
          color = "Status",
        ylab = "Cigarette.Assumption", xlab = "Status") +
   theme_economist()

  wilcox.test(Cigarette.Assumption ~ Status, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.8765, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average Cigarette.Assumption is not significantly different from Died patients average Cigarette.Assumption with a p-value = 0.8765.
 
**B- Cigarettes Assumption with Symptoms:
    
```{r warning=FALSE, , echo=TRUE}

Cigar_Assum_symptoms <- as.data.frame(HCC %>%
                                          summary_factorlist("Symptoms", "Cigarette.Assumption", add_dependent_label = T,cont_cut = 1))
Cigar_Assum_symptoms 

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Cigarette.Assumption, na.rm = TRUE),
    sd = sd(Cigarette.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Cigarette.Assumption, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Cigarette.Assumption", fill = "Symptoms") +
  ggtitle("Relation Between Assumped Packs of Cigarettes per Year and Symptoms") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Cigarette.Assumption", 
          color = "Symptoms",
        ylab = "Cigarette.Assumption", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Cigarette.Assumption ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.2925, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Cigarette.Assumption is not significantly different from Died patients average Cigarette.Assumption with a p-value = 0.2925.
 
**C- Cigarettes Assumption with Performance Status:
    
```{r warning=FALSE, , echo=TRUE}

Cigar_Assum_PS <- as.data.frame(HCC %>%
                  summary_factorlist("PS", "Cigarette.Assumption", add_dependent_label = T, cont_cut = 1))
Cigar_Assum_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Cigarette.Assumption, na.rm = TRUE),
    sd = sd(Cigarette.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Alcohol.Assumption, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Cigarette.Assumption", fill = "PS") +
  ggtitle("Relation Between Assumped Packs of Cigarettes per Year and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "PS", y = "Cigarette.Assumption", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Cigarette.Assumption", xlab = "PS") +
  theme_economist()

Cigar_Assum_PS_anova <- (aov(formula = Cigarette.Assumption ~ PS, data = HCC))
summary(Cigar_Assum_PS_anova)

kruskal.test(formula = Cigarette.Assumption ~ PS, data = HCC)
```

In one-way ANOVA test, a significant p-value = 0.648 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.8706 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Cigarettes Assumption with HCC Stages:
    
```{r warning=FALSE, , echo=TRUE}
Cigaret.asum_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Cigarette.Assumption", add_dependent_label = T, cont_cut = 1))
Cigaret.asum_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Cigarette.Assumption, na.rm = TRUE),
    sd = sd(Cigarette.Assumption, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Alcohol.Assumption, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "PS", y = "Cigarette.Assumption", fill = "PS") +
  ggtitle("Relation Between Assumped Packs of Cigarettes per Year and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "HCC_Stages", y = "Cigarette.Assumption", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Cigarette.Assumption", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Cigar_Assum_Stage_anova <- (aov(formula = Cigarette.Assumption ~ HCC_Stages, data = HCC))
summary(Cigar_Assum_Stage_anova)

kruskal.test(formula = Cigarette.Assumption ~ HCC_Stages, data = HCC)

```

In one-way ANOVA test, a significant p-value = 0.435 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.2262 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#5- Relation Between Diabetes and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Diabetes_sd <- as.data.frame(HCC %>%
                summarise(count = n(), sd = sd(Diabetes, na.rm = T)))

Diabetes_sd

Count_Diabetes <- table(HCC$Diabetes)
Percent_Diabetes <- prop.table(Count_Diabetes)*100

Diabetes_persent <- as.data.frame(cbind(Count_Diabetes, Percent_Diabetes))
Diabetes_persent

ggplot(HCC,aes(Diabetes, fill= Diabetes)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Diabetes)

```

  The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Diabetic status of patients are significantly commonly distributed with a p-value = 1.

**A- Diabetes with Status:

```{r warning=FALSE, , echo=TRUE}

Diabetes_status <- as.data.frame(HCC %>%
                                  summary_factorlist("Status", "Diabetes", add_dependent_label = T,
                                                     cont_cut = 1))
Diabetes_status

Count_Diabetes1 <- table(HCC$Diabetes, HCC$Status)
Percent_Diabetes1 <- prop.table(Count_Diabetes1)*100

Diabetes_persent1 <- as.data.frame(cbind(Count_Diabetes1, Percent_Diabetes1))
Diabetes_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Diabetes, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Diabetes, Status) 
```

 p-value of chi.square is 0.07966 > 0.05. So, this means there is no evidence to suggest that Diabetes tend to cause difference in Status.

**B- Diabetes with Symptoms:
 
```{r warning=FALSE, , echo=TRUE}

Diabetes_symptoms <- as.data.frame(HCC %>%
                                    summary_factorlist("Symptoms", "Diabetes", add_dependent_label = T, cont_cut = 1))
Diabetes_symptoms

Count_Diabetes2 <- table(HCC$Diabetes, HCC$Symptoms)
Percent_Diabetes2 <- prop.table(Count_Diabetes2)*100

Diabetes_persent2 <- as.data.frame(cbind(Count_Diabetes2, Percent_Diabetes2))
Diabetes_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Diabetes, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Diabetes, Symptoms) 
```

 p-value of chi.square is 0.05972 > 0.05. So, this means there is no evidence to suggest that Diabetes tend to cause difference in Symptoms Appearance.
 
**C- Diabetes with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Diabetes_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Diabetes", add_dependent_label = T, cont_cut = 1))
Diabetes_PS

Count_Diabetes3 <- table(HCC$Diabetes, HCC$PS)
Percent_Diabetes3 <- prop.table(Count_Diabetes3)*100

Diabetes_persent3 <- as.data.frame(cbind(Count_Diabetes3, Percent_Diabetes3))
Diabetes_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Diabetes, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Diabetes, PS) 
```

 p-value of chi.square is 0.01474 > 0.05. So, this means there is strong evidence to suggest that Diabetes tend to cause difference in Performance Status.
 
**D- Diabetes with HCC Stage:

```{r warning=FALSE, , echo=TRUE}
Diabetes_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Diabetes", add_dependent_label = T, cont_cut = 1))
Diabetes_Stages

Count_Diabetes4 <- table(HCC$Diabetes, HCC$HCC_Stages)
Percent_Diabetes4 <- prop.table(Count_Diabetes4)*100

Diabetes_persent4 <- as.data.frame(cbind(Count_Diabetes4, Percent_Diabetes4))
Diabetes_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Diabetes, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Diabetes, HCC_Stages) 
```

 p-value of chi.square is 0.9725 > 0.05. So, this means there is no evidence to suggest that Diabetes tend to cause difference in HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#6- Relation Between Obesity and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Obesity_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Obesity, na.rm = T)))

Obesity_sd

Count_Obesity <- table(HCC$Obesity)
Percent_Obesity <- prop.table(Count_Obesity)*100

Obesity_persent <- as.data.frame(cbind(Count_Obesity, Percent_Obesity))
Obesity_persent

ggplot(HCC,aes(Obesity, fill= Obesity)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Obesity)
```

  SD of the Obese population of Intrest is 0.311.
  Total Number of Obese Patients is 22 (10.78%) and Non Obese Patients is 182 (89.22%)
  
 The p-value of the test is 0.8525, which is greater than the significance level alpha = 0.05. We can conclude that the Obesity of patients are significantly commonly distributed with a p-value = 0.8525.
 
**A- Obesity with Status:

```{r warning=FALSE, , echo=TRUE}

Obesity_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Obesity", add_dependent_label = T, cont_cut = 1))
Obesity_status

Count_Obesity1 <- table(HCC$Obesity, HCC$Status)
Percent_Obesity1 <- prop.table(Count_Obesity1)*100

Obesity_persent1 <- as.data.frame(cbind(Count_Obesity1, Percent_Obesity1))
Obesity_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Obesity, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Obesity, Status) 
```

 obese Patients, 9 (4.41%) Dies and 13 (6.37%) Lives.
 Not Obese Patients, 93 (45.59%) Dies and 89 (43.63%) Lives.
 p-value of chi.square is 0.4983 > 0.05. So, this means there is no evidence to suggest that Obesity of patients tend to cause difference in Status.
 
**B- Obesity with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Obesity_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Obesity", add_dependent_label = T,cont_cut = 1))
Obesity_symptoms

Count_Obesity2 <- table(HCC$Obesity, HCC$Symptoms)
Percent_Obesity2 <- prop.table(Count_Obesity2)*100

Obesity_persent2 <- as.data.frame(cbind(Count_Obesity2, Percent_Obesity2))
Obesity_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Obesity, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Obesity, Symptoms) 
```

 obese Patients, 11 (5.39%) Symptomatic and 11 (5.39%) Asymptomatic.
 Not Obese Patients, 130 (63.73%) Symptomatic and 52 (25.49%) Asymptomatic.
 p-value of chi.square is 0.07021 > 0.05. So, this means there is no evidence to suggest that Obesity of patients tend to cause difference in Symptoms Appearance.
 
**C- Obesity with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Obesity_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Obesity", add_dependent_label = T, cont_cut = 1))
Obesity_PS

Count_Obesity3 <- table(HCC$Obesity, HCC$PS)
Percent_Obesity3 <- prop.table(Count_Obesity3)*100

Obesity_persent3 <- as.data.frame(cbind(Count_Obesity3, Percent_Obesity3))
Obesity_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Obesity, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Obesity, PS)
```
    
 obese Patients, 8 (3.92%) Active, 6 (2.94%) needs Ambulatory care and 8 (3.92%) Restricted.
 Not Obese Patients, 80 (39.22%) Active, 31 (15.196%) needs Ambulatory care, 6 (2.94%) Disabled, 36 (17.65%) Restricted and 29 (14.22%) needs Selfcare.
 p-value of chi.square is 0.08692 > 0.05. So, this means there is no evidence to suggest that Obesity of patients tend to cause difference in Performance Status.
 
**D- Obesity with HCC Stage:

```{r warning=FALSE, , echo=TRUE}
Obesity_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Obesity", add_dependent_label = T, cont_cut = 1))
Obesity_Stages 

Count_Obesity4 <- table(HCC$Obesity, HCC$HCC_Stages)
Percent_Obesity4 <- prop.table(Count_Obesity4)*100

Obesity_persent4 <- as.data.frame(cbind(Count_Obesity4, Percent_Obesity4))
Obesity_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Obesity, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Obesity, HCC_Stages) 
```
    
 obese Patients, 1 (0.63%) in Very Early stage, 5 (3.13%) in Early stage (A) and 8 (5%) in Advanced stage (C) and 4 (2.5%) in Terminal stage (D) .
 Not Obese Patients, 1 (0.63%) in Very Early stage, 24 (15%) in Early stage (A), 39 (24.38%) in Intermediate stage (B), 45 (28.13%) in Advanced stage (C) and 33 (20.63%) in Terminal stage (D).
 p-value of chi.square is 0.0442 < 0.05. So, this means there is  evidence to suggest that Obesity of patients tend to cause difference in HCC Stages.

********************************************************************************************************************************************************************************************************

## Third: Analysis of Predisposing Factors:

#Dependent Variable: 
Status, Symptoms, Performance Status, HCC Stages.

#Independent Variables: 
Presence of HB surface Antigen, Presence of HB eAntigen, Presence of HB Core Antibody, Presence of HCV Antibody, Hemochromatosis, Arterial Hypertension, Chronic Renal Insufficiency, HIV, Nonalcoholic Steatohepatitis.

#1- Relation Between HBsAg and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

HBsAg_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(HBsAg, na.rm = T)))

HBsAg_sd


Count <- table(HCC$HBsAg)
Percent <- prop.table(Count)*100

HBsAg_persent <- as.data.frame(cbind(Count, Percent))
HBsAg_persent

ggplot(HCC,aes(HBsAg, fill= HBsAg)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(HBsAg)

```

  SD of the HBsAg population of Intrest is 0.291.

 The p-value of the test is 0.8127, which is greater than the significance level alpha = 0.05. We can conclude that Patients with HBsAg Positive are significantly commonly distributed a p-value = 0.8127.
 
**A- HBsAg with Status:

```{r warning=FALSE, , echo=TRUE}

HBsAg_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "HBsAg", add_dependent_label = T, cont_cut = 1))
HBsAg_status


Count1 <- table(HCC$HBsAg, HCC$Status)
Percent1 <- prop.table(Count1)*100

HBsAg_Status_persent <- as.data.frame(cbind(Count1, Percent1))
HBsAg_Status_persent

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~HBsAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBsAg, Status)

```

 p-value of chi.square is 0.6299 > 0.05. So, this means there is no evidence to suggest that Patients with HBsAg Positive tends to have different Status.
 
**B- HBsAg with Symptoms:

```{r warning=FALSE, , echo=TRUE}

HBsAg_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "HBsAg", add_dependent_label = T,cont_cut = 1))
HBsAg_symptoms

Count2 <- table(HCC$HBsAg, HCC$Symptoms)
Percent2 <- prop.table(Count2)*100

HBsAg_Symptoms_persent <- as.data.frame(cbind(Count2, Percent2))
HBsAg_Symptoms_persent

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~HBsAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBsAg, Symptoms) 
```

 p-value of chi.square is 0.4758 > 0.05. So, this means there is no evidence to suggest that Patients with HBsAg Positive tends to have different Symptoms Appearance.
 
**C- HBsAg with Performance Status:

```{r warning=FALSE, , echo=TRUE}

HBsAg_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "HBsAg", add_dependent_label = T, cont_cut = 1))
HBsAg_PS

Count3 <- table(HCC$HBsAg, HCC$PS)
Percent3 <- prop.table(Count3)*100

HBsAg_PS_persent <- as.data.frame(cbind(Count3, Percent3))
HBsAg_PS_persent


ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~HBsAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBsAg, PS)
```

 p-value of chi.square is 0.006489 < 0.05. So, this means there is evidence to suggest that Patients with HBsAg Positive tends to have different Performance Status.
 
**D- HBsAg with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

HBsAg_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "HBsAg", add_dependent_label = T, cont_cut = 1))
HBsAg_Stages 


Count4 <- table(HCC$HBsAg, HCC$HCC_Stages)
Percent4 <- prop.table(Count4)*100

HBsAg_Stages_persent <- as.data.frame(cbind(Count4, Percent4))
HBsAg_Stages_persent


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~HBsAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBsAg, HCC_Stages)

```

 p-value of chi.square is 0.1157 > 0.05. So, this means there is no evidence to suggest that Patients with HBsAg Positive tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#2- Relation Between HBeAg and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

HBeAg_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(HBeAg, na.rm = T)))

HBeAg_sd

Count_HBeAg <- table(HCC$HBeAg)
Percent_HBeAg <- prop.table(Count_HBeAg)*100

HBeAg_persent <- as.data.frame(cbind(Count_HBeAg, Percent_HBeAg))
HBeAg_persent


ggplot(HCC,aes(HBeAg, fill= HBeAg)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(HBeAg)

```

  SD of the HBsAg population of Intrest is 0.121.

 The p-value of the test is 0.5265, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with HBeAg Positive are significantly commonly distributed with a p-value = 0.5265.
 
**A- HBeAg with Status:

```{r warning=FALSE, , echo=TRUE}

HBeAg_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "HBeAg", add_dependent_label = T, cont_cut = 1))
HBeAg_status

Count_HBeAg1 <- table(HCC$HBeAg, HCC$Status)
Percent_HBeAg1 <- prop.table(Count_HBeAg1)*100

HBeAg_persent1 <- as.data.frame(cbind(Count_HBeAg1, Percent_HBeAg1))
HBeAg_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~HBeAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBeAg, Status)

```

 p-value of chi.square is 0.2447 > 0.05. So, this means there is no evidence to suggest that Patients with HBeAg Positive tends to have different Status.
 
**B- HBeAg with Symptoms:

```{r warning=FALSE, , echo=TRUE}

HBeAg_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "HBeAg", add_dependent_label = T,cont_cut = 1))
HBeAg_symptoms

Count_HBeAg2 <- table(HCC$HBeAg, HCC$Symptoms)
Percent_HBeAg2 <- prop.table(Count_HBeAg2)*100

HBeAg_persent2 <- as.data.frame(cbind(Count_HBeAg2, Percent_HBeAg2))
HBeAg_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~HBeAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBeAg, Symptoms) 
```

 p-value of chi.square is 0.5913 > 0.05. So, this means there is no evidence to suggest that Patients with HBeAg Positive tends to have different Symptoms Appearance.
 
**C- HBeAg with Performance Status:

```{r warning=FALSE, , echo=TRUE}

HBeAg_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "HBeAg", add_dependent_label = T, cont_cut = 1))
HBeAg_PS

Count_HBeAg3 <- table(HCC$HBeAg, HCC$PS)
Percent_HBeAg3 <- prop.table(Count_HBeAg3)*100

HBeAg_persent3 <- as.data.frame(cbind(Count_HBeAg3, Percent_HBeAg3))
HBeAg_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~HBeAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBeAg, PS)
```

 p-value of chi.square is < 2.2e-16 < 0.05. So, this means there is evidence to suggest that Patients with HBeAg Positive tends to have different Performance Status.
 
**D- HBeAg with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

HBeAg_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "HBeAg", add_dependent_label = T, cont_cut = 1))
HBeAg_Stages 


Count_HBeAg4 <- table(HCC$HBeAg, HCC$HCC_Stages)
Percent_HBeAg4 <- prop.table(Count_HBeAg4)*100

HBeAg_persent4 <- as.data.frame(cbind(Count_HBeAg4, Percent_HBeAg4))
HBeAg_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~HBeAg, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBeAg, HCC_Stages)

```

 p-value of chi.square is 0.1507 > 0.05. So, this means there is no evidence to suggest that Patients with HBeAg Positive tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#3- Relation Between HBcAb and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

HBcAb_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(HBcAb, na.rm = T)))

HBcAb_sd

Count_HBcAb <- table(HCC$HBcAb)
Percent_HBcAb <- prop.table(Count_HBcAb)*100

HBcAb_persent <- as.data.frame(cbind(Count_HBcAb, Percent_HBcAb))
HBcAb_persent


ggplot(HCC,aes(HBcAb, fill= HBcAb)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(HBcAb)

```

 The p-value of the test is 0.9975, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with HBcAb Positive are significantly commonly distributed with a p-value = 0.9975.
 
**A- HBcAb with Status:

```{r warning=FALSE, , echo=TRUE}

HBcAb_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "HBcAb", add_dependent_label = T, cont_cut = 1))
HBcAb_status

Count_HBcAb1 <- table(HCC$HBcAb, HCC$Status)
Percent_HBcAb1 <- prop.table(Count_HBcAb1)*100

HBcAb_persent1 <- as.data.frame(cbind(Count_HBcAb1, Percent_HBcAb1))
HBcAb_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~HBcAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBcAb, Status)

```

 p-value of chi.square is 0.5231 > 0.05. So, this means there is no evidence to suggest that Patients with HBcAb Positive tends to have different Status.
 
**B- HBcAb with Symptoms:

```{r warning=FALSE, , echo=TRUE}

HBcAb_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "HBcAb", add_dependent_label = T,cont_cut = 1))
HBcAb_symptoms

Count_HBcAb2 <- table(HCC$HBcAb, HCC$Symptoms)
Percent_HBcAb2 <- prop.table(Count_HBcAb2)*100

HBcAb_persent2 <- as.data.frame(cbind(Count_HBcAb2, Percent_HBcAb2))
HBcAb_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~HBcAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBcAb, Symptoms) 
```

 p-value of chi.square is 0.09254 > 0.05. So, this means there is no evidence to suggest that Patients with HBcAb Positive tends to have different Symptoms Appearance.
 
**C- HBcAb with Performance Status:

```{r warning=FALSE, , echo=TRUE}

HBcAb_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "HBcAb", add_dependent_label = T, cont_cut = 1))
HBcAb_PS

Count_HBcAb3 <- table(HCC$HBcAb, HCC$PS)
Percent_HBcAb3 <- prop.table(Count_HBcAb3)*100

HBcAb_persent3 <- as.data.frame(cbind(Count_HBcAb3, Percent_HBcAb3))
HBcAb_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~HBcAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBcAb, PS)
```

 p-value of chi.square is 0.1206 > 0.05. So, this means there is no evidence to suggest that Patients with HBcAb Positive tends to have different Performance Status.
 
**D- HBcAb with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

HBcAb_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "HBcAb", add_dependent_label = T, cont_cut = 1))
HBcAb_Stages 

Count_HBcAb4 <- table(HCC$HBcAb, HCC$HCC_Stages)
Percent_HBcAb4 <- prop.table(Count_HBcAb4)*100

HBcAb_persent4 <- as.data.frame(cbind(Count_HBcAb4, Percent_HBcAb4))
HBcAb_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~HBcAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HBcAb, HCC_Stages)

```

 p-value of chi.square is 0.4808 > 0.05. So, this means there is no evidence to suggest that Patients with HBcAb Positive tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#4- Relation Between HCVAb and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

HCVAb_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(HCVAb, na.rm = T)))

HCVAb_sd

Count_HCVAb <- table(HCC$HCVAb)
Percent_HCVAb <- prop.table(Count_HCVAb)*100

HCVAb_persent <- as.data.frame(cbind(Count_HCVAb, Percent_HCVAb))
HCVAb_persent

ggplot(HCC,aes(HCVAb, fill= HCVAb)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(HCVAb)

```

 The p-value of the test is 0.9845, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with HCVAb Positive are significantly commonly distributed with a p-value = 0.9845.
 
**A- HCVAb with Status:

```{r warning=FALSE, , echo=TRUE}

HCVAb_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "HCVAb", add_dependent_label = T, cont_cut = 1))
HCVAb_status

Count_HCVAb1 <- table(HCC$HCVAb, HCC$Status)
Percent_HCVAb1 <- prop.table(Count_HCVAb1)*100

HCVAb_persent1 <- as.data.frame(cbind(Count_HCVAb1, Percent_HCVAb1))
HCVAb_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~HCVAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCVAb, Status)

```

 p-value of chi.square is 0.3866 > 0.05. So, this means there is no evidence to suggest that Patients with HCVAb Positive tends to have different Status.
 
**B- HCVAb with Symptoms:

```{r warning=FALSE, , echo=TRUE}

HCVAb_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "HCVAb", add_dependent_label = T,cont_cut = 1))
HCVAb_symptoms

Count_HCVAb2 <- table(HCC$HCVAb, HCC$Symptoms)
Percent_HCVAb2 <- prop.table(Count_HCVAb2)*100

HCVAb_persent2 <- as.data.frame(cbind(Count_HCVAb2, Percent_HCVAb2))
HCVAb_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~HCVAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCVAb, Symptoms) 
```

 p-value of chi.square is 0.8427 > 0.05. So, this means there is no evidence to suggest that Patients with HCVAb Positive tends to have different Symptoms Appearance.
 
**C- HCVAb with Performance Status:

```{r warning=FALSE, , echo=TRUE}

HCVAb_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "HCVAb", add_dependent_label = T, cont_cut = 1))
HCVAb_PS

Count_HCVAb3 <- table(HCC$HCVAb, HCC$PS)
Percent_HCVAb3 <- prop.table(Count_HCVAb3)*100

HCVAb_persent3 <- as.data.frame(cbind(Count_HCVAb3, Percent_HCVAb3))
HCVAb_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~HCVAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCVAb, PS)
```
    
 p-value of chi.square is 0.07061 > 0.05. So, this means there is no evidence to suggest that Patients with HCVAb Positive tends to have different Performance Status.
 
**D- HCVAb with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

HCVAb_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "HCVAb", add_dependent_label = T, cont_cut = 1))
HCVAb_Stages 

Count_HCVAb4 <- table(HCC$HCVAb, HCC$HCC_Stages)
Percent_HCVAb4 <- prop.table(Count_HCVAb4)*100

HCVAb_persent4 <- as.data.frame(cbind(Count_HCVAb4, Percent_HCVAb4))
HCVAb_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~HCVAb, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HCVAb, HCC_Stages)

```

 p-value of chi.square is 0.3778 > 0.05. So, this means there is no evidence to suggest that Patients with HCVAb Positive tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#5- Relation Between Hemochromatosis and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Hemochro_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Hemochro, na.rm = T)))

Hemochro_sd

Count_Hemochro <- table(HCC$Hemochro)
Percent_Hemochro <- prop.table(Count_Hemochro)*100

Hemochro_persent <- as.data.frame(cbind(Count_Hemochro, Percent_Hemochro))
Hemochro_persent

ggplot(HCC,aes(Hemochro, fill= Hemochro)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Hemochro)

```

 The p-value of the test is 0.6813, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Hemochromatosis Positive are significantly commonly distributed with a p-value = 0.6813.
 
**A- Hemochromatosis with Status:

```{r warning=FALSE, , echo=TRUE}

Hemochro_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Hemochro", add_dependent_label = T, cont_cut = 1))
Hemochro_status

Count_Hemochro1 <- table(HCC$Hemochro, HCC$Status)
Percent_Hemochro1 <- prop.table(Count_Hemochro1)*100

Hemochro_persent1 <- as.data.frame(cbind(Count_Hemochro1, Percent_Hemochro1))
Hemochro_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Hemochro, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hemochro, Status)

```

 p-value of chi.square is 1 > 0.05. So, this means there is no evidence to suggest that Patients with Hemochromatosis Positive tends to have different Status.
 
**B- Hemochromatosis with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Hemochro_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Hemochro", add_dependent_label = T,cont_cut = 1))
Hemochro_symptoms

Count_Hemochro2 <- table(HCC$Hemochro, HCC$Symptoms)
Percent_Hemochro2 <- prop.table(Count_Hemochro2)*100

Hemochro_persent2 <- as.data.frame(cbind(Count_Hemochro2, Percent_Hemochro2))
Hemochro_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Hemochro, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hemochro, Symptoms) 
```

 p-value of chi.square is 0.9449 > 0.05. So, this means there is no evidence to suggest that Patients with Hemochromatosis Positive tends to have different Symptoms Appearance.
 
**C- Hemochromatosis with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Hemochro_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Hemochro", add_dependent_label = T, cont_cut = 1))
Hemochro_PS

Count_Hemochro3 <- table(HCC$Hemochro, HCC$PS)
Percent_Hemochro3 <- prop.table(Count_Hemochro3)*100

Hemochro_persent3 <- as.data.frame(cbind(Count_Hemochro3, Percent_Hemochro3))
Hemochro_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Hemochro, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hemochro, PS)
```
    
 p-value of chi.square is 0.1426 > 0.05. So, this means there is no evidence to suggest that Patients with Hemochromatosis Positive tends to have different Performance Status.
 
**D- Hemochromatosis with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Hemochro_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Hemochro", add_dependent_label = T, cont_cut = 1))
Hemochro_Stages 

Count_Hemochro4 <- table(HCC$Hemochro, HCC$HCC_Stages)
Percent_Hemochro4 <- prop.table(Count_Hemochro4)*100

Hemochro_persent4 <- as.data.frame(cbind(Count_Hemochro4, Percent_Hemochro4))
Hemochro_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Hemochro, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hemochro, HCC_Stages)

```

 p-value of chi.square is 0.5671 > 0.05. So, this means there is no evidence to suggest that Patients with Hemochromatosis Positive tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#6- Relation Between Arterial Hypertension and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

AHT_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(AHT, na.rm = T)))

AHT_sd

Count_AHT <- table(HCC$AHT)
Percent_AHT <- prop.table(Count_AHT)*100

AHT_persent <- as.data.frame(cbind(Count_AHT, Percent_AHT))
AHT_persent

ggplot(HCC,aes(AHT, fill= AHT)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(AHT)

```

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Arterial Hypertension are significantly commonly distributed with a p-value = 1.
 
**A- AHT with Status:

```{r warning=FALSE, , echo=TRUE}

AHT_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "AHT", add_dependent_label = T, cont_cut = 1))
AHT_status

Count_AHT1 <- table(HCC$AHT, HCC$Status)
Percent_AHT1 <- prop.table(Count_AHT1)*100

AHT_persent1 <- as.data.frame(cbind(Count_AHT1, Percent_AHT1))
AHT_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~AHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(AHT, Status)

```

 p-value of chi.square is 0.7715 > 0.05. So, this means there is no evidence to suggest that Patients with Arterial Hypertension tends to have different Status.
 
**B- AHT with Symptoms:

```{r warning=FALSE, , echo=TRUE}

AHT_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "AHT", add_dependent_label = T,cont_cut = 1))
AHT_symptoms

Count_AHT2 <- table(HCC$AHT, HCC$Symptoms)
Percent_AHT2 <- prop.table(Count_AHT2)*100

AHT_persent2 <- as.data.frame(cbind(Count_AHT2, Percent_AHT2))
AHT_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~AHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(AHT, Symptoms) 
```

 p-value of chi.square is 0.03628 < 0.05. So, this means there is evidence to suggest that Patients with Arterial Hypertension tends to have different Symptoms Appearance.
 
**C- AHT with Performance Status:

```{r warning=FALSE, , echo=TRUE}

AHT_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "AHT", add_dependent_label = T, cont_cut = 1))
AHT_PS

Count_AHT3 <- table(HCC$AHT, HCC$PS)
Percent_AHT3 <- prop.table(Count_AHT3)*100

AHT_persent3 <- as.data.frame(cbind(Count_AHT3, Percent_AHT3))
AHT_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~AHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(AHT, PS)
```
    
 p-value of chi.square is 0.1287 > 0.05. So, this means there is no evidence to suggest that Patients with Arterial Hypertension tends to have different Performance Status.
 
**D- AHT with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

AHT_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "AHT", add_dependent_label = T, cont_cut = 1))
AHT_Stages 

Count_AHT4 <- table(HCC$AHT, HCC$HCC_Stages)
Percent_AHT4 <- prop.table(Count_AHT4)*100

AHT_persent4 <- as.data.frame(cbind(Count_AHT4, Percent_AHT4))
AHT_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~AHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(AHT, HCC_Stages)

```

 p-value of chi.square is 0.1728 > 0.05. So, this means there is no evidence to suggest that Patients with Arterial Hypertension tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#7- Relation Between Chronic Renal Insufficiency and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

CRI_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(CRI, na.rm = T)))

CRI_sd

Count_CRI <- table(HCC$CRI)
Percent_CRI <- prop.table(Count_CRI)*100

CRI_persent <- as.data.frame(cbind(Count_CRI, Percent_CRI))
CRI_persent

ggplot(HCC,aes(CRI, fill= CRI)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(CRI)

```

 The p-value of the test is 0.923, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Chronic Renal Insufficiency are significantly commonly distributed with a p-value = 0.923.
 
**A- CRI with Status:

```{r warning=FALSE, , echo=TRUE}

CRI_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "CRI", add_dependent_label = T, cont_cut = 1))
CRI_status

Count_CRI1 <- table(HCC$CRI, HCC$Status)
Percent_CRI1 <- prop.table(Count_CRI1)*100

CRI_persent1 <- as.data.frame(cbind(Count_CRI1, Percent_CRI1))
CRI_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~CRI, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(CRI, Status)

```

 p-value of chi.square is 0.1087 > 0.05. So, this means there is no evidence to suggest that Patients with Chronic Renal Insufficiency tends to have different Status.
 
**B- CRI with Symptoms:

```{r warning=FALSE, , echo=TRUE}

CRI_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "CRI", add_dependent_label = T,cont_cut = 1))
CRI_symptoms

Count_CRI2 <- table(HCC$CRI, HCC$Symptoms)
Percent_CRI2 <- prop.table(Count_CRI2)*100

CRI_persent2 <- as.data.frame(cbind(Count_CRI2, Percent_CRI2))
CRI_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~CRI, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(CRI, Symptoms) 
```

 p-value of chi.square is 0.5275 > 0.05. So, this means there is no evidence to suggest that Patients with Chronic Renal Insufficiency Positive tends to have different Symptoms Appearance.
 
**C- CRI with Performance Status:

```{r warning=FALSE, , echo=TRUE}

CRI_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "CRI", add_dependent_label = T, cont_cut = 1))
CRI_PS

Count_CRI3 <- table(HCC$CRI, HCC$PS)
Percent_CRI3 <- prop.table(Count_CRI3)*100

CRI_persent3 <- as.data.frame(cbind(Count_CRI3, Percent_CRI3))
CRI_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~CRI, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(CRI, PS)
```
    
 p-value of chi.square is 0.1787 > 0.05. So, this means there is no evidence to suggest that Patients with Chronic Renal Insufficiency Positive tends to have different Performance Status.
 
**D- CRI with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

CRI_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "CRI", add_dependent_label = T, cont_cut = 1))
CRI_Stages 

Count_CRI4 <- table(HCC$CRI, HCC$HCC_Stages)
Percent_CRI4 <- prop.table(Count_CRI4)*100

CRI_persent4 <- as.data.frame(cbind(Count_CRI4, Percent_CRI4))
CRI_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~CRI, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(CRI, HCC_Stages)

```

 p-value of chi.square is 0.8064 > 0.05. So, this means there is no evidence to suggest that Patients with Chronic Renal Insufficiency tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#8- Relation Between HIV and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

HIV_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(HIV, na.rm = T)))

HIV_sd

Count_HIV <- table(HCC$HIV)
Percent_HIV <- prop.table(Count_HIV)*100

HIV_persent <- as.data.frame(cbind(Count_HIV, Percent_HIV))
HIV_persent

ggplot(HCC,aes(HIV, fill= HIV)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(HIV)

```

 The p-value of the test is 0.5265, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with HIV are significantly commonly distributed with a p-value = 0.923.
 
**A- HIV with Status:

```{r warning=FALSE, , echo=TRUE}

HIV_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "HIV", add_dependent_label = T, cont_cut = 1))
HIV_status

Count_HIV1 <- table(HCC$HIV, HCC$Status)
Percent_HIV1 <- prop.table(Count_HIV1)*100

HIV_persent1 <- as.data.frame(cbind(Count_HIV1, Percent_HIV1))
HIV_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~HIV, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HIV, Status)

```

 p-value of chi.square is 1 > 0.05. So, this means there is no evidence to suggest that Patients with HIV tends to have different Status.
 
**B- HIV with Symptoms:

```{r warning=FALSE, , echo=TRUE}

HIV_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "HIV", add_dependent_label = T,cont_cut = 1))
HIV_symptoms

Count_HIV2 <- table(HCC$HIV, HCC$Symptoms)
Percent_HIV2 <- prop.table(Count_HIV2)*100

HIV_persent2 <- as.data.frame(cbind(Count_HIV2, Percent_HIV2))
HIV_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~HIV, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HIV, Symptoms) 
```

 p-value of chi.square is 0.04759 < 0.05. So, this means there is evidence to suggest that Patients with HIV tends to have different Symptoms Appearance.
 
**C- HIV with Performance Status:

```{r warning=FALSE, , echo=TRUE}

HIV_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "HIV", add_dependent_label = T, cont_cut = 1))
HIV_PS

Count_HIV3 <- table(HCC$HIV, HCC$PS)
Percent_HIV3 <- prop.table(Count_HIV3)*100

HIV_persent3 <- as.data.frame(cbind(Count_HIV3, Percent_HIV3))
HIV_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~HIV, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HIV, PS)
```
    
 p-value of chi.square is 0.7436 > 0.05. So, this means there is no evidence to suggest that Patients with HIV Positive tends to have different Performance Status.
 
**D- HIV with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

HIV_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "HIV", add_dependent_label = T, cont_cut = 1))
HIV_Stages 

Count_HIV4 <- table(HCC$HIV, HCC$HCC_Stages)
Percent_HIV4 <- prop.table(Count_HIV4)*100

HIV_persent4 <- as.data.frame(cbind(Count_HIV4, Percent_HIV4))
HIV_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~HIV, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(HIV, HCC_Stages)

```

 p-value of chi.square is 0.6814 > 0.05. So, this means there is no evidence to suggest that Patients with HIV tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#9- Relation Between Nonalcoholic Steatohepatitis and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

NASH_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(NASH, na.rm = T)))

NASH_sd

Count_NASH <- table(HCC$NASH)
Percent_NASH <- prop.table(Count_NASH)*100

NASH_persent <- as.data.frame(cbind(Count_NASH, Percent_NASH))
NASH_persent

ggplot(HCC,aes(NASH, fill= NASH)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(NASH)

```

 The p-value of the test is 0.6628, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with NASH are significantly commonly distributed with a p-value = 0.6628.
 
**A- NASH with Status:

```{r warning=FALSE, , echo=TRUE}

NASH_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "NASH", add_dependent_label = T, cont_cut = 1))
NASH_status

Count_NASH1 <- table(HCC$NASH, HCC$Status)
Percent_NASH1 <- prop.table(Count_NASH1)*100

NASH_persent1 <- as.data.frame(cbind(Count_NASH1, Percent_NASH1))
NASH_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~NASH, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(NASH, Status)

```

 p-value of chi.square is 0.3306 > 0.05. So, this means there is no evidence to suggest that Patients with NASH tends to have different Status.
 
**B- NASH with Symptoms:

```{r warning=FALSE, , echo=TRUE}

NASH_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "NASH", add_dependent_label = T,cont_cut = 1))
NASH_symptoms

Count_NASH2 <- table(HCC$NASH, HCC$Symptoms)
Percent_NASH2 <- prop.table(Count_NASH2)*100

NASH_persent2 <- as.data.frame(cbind(Count_NASH2, Percent_NASH2))
NASH_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~NASH, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(NASH, Symptoms) 
```

 p-value of chi.square is 0.6797 > 0.05. So, this means there is no evidence to suggest that Patients with NASH tends to have different Symptoms Appearance.
 
**C- NASH with Performance Status:

```{r warning=FALSE, , echo=TRUE}

NASH_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "NASH", add_dependent_label = T, cont_cut = 1))
NASH_PS

Count_NASH3 <- table(HCC$NASH, HCC$PS)
Percent_NASH3 <- prop.table(Count_NASH3)*100

NASH_persent3 <- as.data.frame(cbind(Count_NASH3, Percent_NASH3))
NASH_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~NASH, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(NASH, PS)
```
    
 p-value of chi.square is 0.8637 > 0.05. So, this means there is no evidence to suggest that Patients with NASH Positive tends to have different Performance Status.
 
**D- NASH with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

NASH_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "NASH", add_dependent_label = T, cont_cut = 1))
NASH_Stages 

Count_NASH4 <- table(HCC$NASH, HCC$HCC_Stages)
Percent_NASH4 <- prop.table(Count_NASH4)*100

NASH_persent4 <- as.data.frame(cbind(Count_NASH4, Percent_NASH4))
NASH_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~NASH, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(NASH, HCC_Stages)

```

 p-value of chi.square is 0.01792 < 0.05. So, this means there is evidence to suggest that Patients with NASH tends to have different HCC Stages.
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#10- Relation Between Cirrhosis and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Cirrhosis_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Cirrhosis, na.rm = T)))

Cirrhosis_sd

Count_Cirrhosis <- table(HCC$Cirrhosis)
Percent_Cirrhosis <- prop.table(Count_Cirrhosis)*100

Cirrhosis_persent <- as.data.frame(cbind(Count_Cirrhosis, Percent_Cirrhosis))
Cirrhosis_persent

ggplot(HCC,aes(Cirrhosis, fill= Cirrhosis)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Cirrhosis)

```

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Cirrhosis are significantly commonly distributed with a p-value = 1.
 
**A- Cirrhosis with Status:

```{r warning=FALSE, , echo=TRUE}

Cirrhosis_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Cirrhosis", add_dependent_label = T, cont_cut = 1))
Cirrhosis_status

Count_Cirrhosis1 <- table(HCC$Cirrhosis, HCC$Status)
Percent_Cirrhosis1 <- prop.table(Count_Cirrhosis1)*100

Cirrhosis_persent1 <- as.data.frame(cbind(Count_Cirrhosis1, Percent_Cirrhosis1))
Cirrhosis_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Cirrhosis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Cirrhosis, Status)

```

 p-value of chi.square is 0.6449 > 0.05. So, this means there is no evidence to suggest that Patients with Cirrhosis tends to have different Status.
 
**B- Cirrhosis with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Cirrhosis_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Cirrhosis", add_dependent_label = T,cont_cut = 1))
Cirrhosis_symptoms

Count_Cirrhosis2 <- table(HCC$Cirrhosis, HCC$Symptoms)
Percent_Cirrhosis2 <- prop.table(Count_Cirrhosis2)*100

Cirrhosis_persent2 <- as.data.frame(cbind(Count_Cirrhosis2, Percent_Cirrhosis2))
Cirrhosis_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Cirrhosis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Cirrhosis, Symptoms) 
```

 p-value of chi.square is 0.1366 > 0.05. So, this means there is no evidence to suggest that Patients with Cirrhosis tends to have different Symptoms Appearance.
 
**C- Cirrhosis with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Cirrhosis_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Cirrhosis", add_dependent_label = T, cont_cut = 1))
Cirrhosis_PS

Count_Cirrhosis3 <- table(HCC$Cirrhosis, HCC$PS)
Percent_Cirrhosis3 <- prop.table(Count_Cirrhosis3)*100

Cirrhosis_persent3 <- as.data.frame(cbind(Count_Cirrhosis3, Percent_Cirrhosis3))
Cirrhosis_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Cirrhosis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Cirrhosis, PS)
```
    
 p-value of chi.square is 0.1498 > 0.05. So, this means there is no evidence to suggest that Patients with Cirrhosis Positive tends to have different Performance Status.
 
**D- Cirrhosis with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Cirrhosis_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Cirrhosis", add_dependent_label = T, cont_cut = 1))
Cirrhosis_Stages 

Count_Cirrhosis4 <- table(HCC$Cirrhosis, HCC$HCC_Stages)
Percent_Cirrhosis4 <- prop.table(Count_Cirrhosis4)*100

Cirrhosis_persent4 <- as.data.frame(cbind(Count_Cirrhosis4, Percent_Cirrhosis4))
Cirrhosis_persent4

ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Cirrhosis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Cirrhosis, HCC_Stages)

```

 p-value of chi.square is 0.4255 > 0.05. So, this means there is evidence to suggest that Patients with Cirrhosis tends to have different HCC Stages.
 
**D-1 Relation Between No. of Nodules and Prescence of Cirrhosis:
     
```{r warning=FALSE, , echo=TRUE}

Nodule_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Nodule, na.rm = T), sd = sd(Nodule, na.rm = T)))
Nodule_mean

hist(Nodule)

ggplot(HCC, aes(x=Nodule)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$Nodule)
  kurtosis(HCC$Nodule)
  
  shapiro.test(Nodule)

```

  Mean No. of Nodule in population of Intrest is 3.735 and standard Deviation is 1.736.
  The Distribution is moderatly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
From the output, the p-values = 2.232e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

*Nodule with Cirrhosis:

```{r warning=FALSE, , echo=TRUE}

Nodule_Cirrhosis <- as.data.frame(HCC %>%
                 summary_factorlist("Cirrhosis", "Nodule", add_dependent_label = T, cont_cut = 1))

Nodule_Cirrhosis

group_by(HCC, Cirrhosis) %>%
  summarise(
    count = n(),
    mean = mean(Nodule, na.rm = TRUE),
    sd = sd(Nodule, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Cirrhosis, y = Nodule, fill = Cirrhosis)) +
  geom_col() +
  labs(x = "Cirrhosis", y = "Nodule", fill = "Cirrhosis") +
  ggtitle("Relation Between No. of Nodules and Cirrhosis of Patients") +
  scale_fill_discrete(name = "Cirrhosis") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Cirrhosis", y = "Nodule", 
          color = "Cirrhosis",
        ylab = "Nodule", xlab = "Cirrhosis") +
   theme_economist()

  wilcox.test(Nodule ~ Cirrhosis, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.02921, which is less than the significance level alpha = 0.05. We can conclude that Average No. of Nodules in patient with Cirrhosis is significantly different from Average No. of Nodules in patient without Cirrhosis with a p-value = 0.02921.
 
 
**D-2 Relation Between Dimention of Nodules and Prescence of Cirrhosis:
     
```{r warning=FALSE, , echo=TRUE}

Major_Dim_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Major_Dim, na.rm = T), sd = sd(Major_Dim, na.rm = T)))
Major_Dim_mean

hist(Major_Dim)

ggplot(HCC, aes(x=Major_Dim)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$Major_Dim)
  kurtosis(HCC$Major_Dim)
  
  shapiro.test(Major_Dim)

```

  Mean Dimention of Nodules in population of Intrest is 3.735 and standard Deviation is 1.736.
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
From the output, the p-values = 1.165e-12< the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

*Dimention of Nodules with Cirrhosis:

```{r warning=FALSE, , echo=TRUE}

Major_Dim_Cirrhosis <- as.data.frame(HCC %>%
                 summary_factorlist("Cirrhosis", "Major_Dim", add_dependent_label = T, cont_cut = 1))

Major_Dim_Cirrhosis

group_by(HCC, Cirrhosis) %>%
  summarise(
    count = n(),
    mean = mean(Major_Dim, na.rm = TRUE),
    sd = sd(Major_Dim, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Cirrhosis, y = Major_Dim, fill = Cirrhosis)) +
  geom_col() +
  labs(x = "Cirrhosis", y = "Major_Dim", fill = "Cirrhosis") +
  ggtitle("Relation Between Dimention of Nodules and Cirrhosis of Patients") +
  scale_fill_discrete(name = "Cirrhosis") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Cirrhosis", y = "Major_Dim", 
          color = "Cirrhosis",
        ylab = "Major_Dim", xlab = "Cirrhosis") +
   theme_economist()

  wilcox.test(Major_Dim ~ Cirrhosis, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 1.872e-06, which is less than the significance level alpha = 0.05. We can conclude that Average Dimention of Nodules in patient with Cirrhosis is significantly different from Average Dimention of Nodules in patient without Cirrhosis with a p-value = 1.872e-06.
 

**********************************************************************************************************************************************************************************************************************************************************************************************

## Fourth: Analysis of Lab Results according to Dependent Variable:

#1- International Normalized Ratio (INR):
     
```{r warning=FALSE, , echo=TRUE}

INR_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(INR, na.rm = T), sd = sd(INR, na.rm = T)))
INR_mean

hist(INR)
  boxplot(INR ~ Status, data = HCC, xlab = "Status", ylab = "INR",
          main = "Relation Between INR and Starus of Patients")

ggplot(HCC, aes(x=INR)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$INR)
  kurtosis(HCC$INR)
  
  shapiro.test(INR)

```

  Mean INR of population of Intrest is 1.445 and standard Deviation is 0.48.
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- INR with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

INR_status <- as.data.frame(HCC %>%
                 summary_factorlist("Status", "INR", add_dependent_label = T, cont_cut = 1))

INR_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(INR, na.rm = TRUE),
    sd = sd(INR, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = INR, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "INR", fill = "Status") +
  ggtitle("Relation Between INR Value and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "INR", 
          color = "Status",
        ylab = "INR", xlab = "Status") +
   theme_economist()

  wilcox.test(INR ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.00535, which is less than the significance level alpha = 0.05. We can conclude that Live patient average INR is significantly different from Died patients average INR with a p-value = 0.00535.
 
**B- INR with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

INR_symp <- as.data.frame(HCC %>%
                                        summary_factorlist("Symptoms", "INR", add_dependent_label = T, cont_cut = 1))

INR_symp 

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(INR, na.rm = TRUE),
    sd = sd(INR, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = INR, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "INR", fill = "Symptoms") +
  ggtitle("Relation Between INR Value and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "INR", 
          color = "Symptoms",
        ylab = "INR", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(INR ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.445, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average INR is not significantly different from Asymptomatic patients average INR with a p-value = 0.445.
 
**C- INR with Performance Status:

```{r warning=FALSE, , echo=TRUE}

INR_PS <- as.data.frame(HCC %>%
                                        summary_factorlist("PS", "INR", add_dependent_label = T, cont_cut = 1))

INR_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(INR, na.rm = TRUE),
    sd = sd(INR, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = INR, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "INR", fill = "PS") +
  ggtitle("Relation Between INR Value and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "PS", y = "INR", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "INR", xlab = "PS") +
  theme_economist()

INR_PS_anova <- (aov(formula = INR ~ PS, data = HCC))
summary(INR_PS_anova)
TukeyHSD(INR_PS_anova)
plot(TukeyHSD(INR_PS_anova))

```

In one-way ANOVA test, a significant p-value = 0.00255 indicates that significant relationship between INR and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in INR Values from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in INR Values between:
Restricted-Active ( p =0.4120371 > 0.05), as well as between West Selfcare-Active (p=0.5368412) or Disabled-Ambulatory (p=0.7641636), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in INR Values between Ambulatory-Active (p= 0.0087959) as well as between Disabled-Active (p=0.0466377).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- INR with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

INR_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "INR", add_dependent_label = T, cont_cut = 1))

INR_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(INR, na.rm = TRUE),
    sd = sd(INR, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = INR, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "INR", fill = "HCC_Stages") +
  ggtitle("Relation Between INR Value and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "HCC_Stages", y = "INR", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "INR", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

INR_Stages_anova <- (aov(formula = INR ~ HCC_Stages, data = HCC))
summary(INR_Stages_anova)
TukeyHSD(INR_Stages_anova)
plot(TukeyHSD(INR_Stages_anova))

```

 In one-way ANOVA test, a significant p-value = 0.0125 indicates that significant relationship between INR and HCC Stages (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in INR Values from Different HCC Stages. So, We can conclude that:

1- There is no significant difference in INR Values between:
Early stage (A)-Advanced stage (C) ( p =0.9995435 > 0.05), as well as between Intermediate stage (B)-Advanced stage (C) (p=0.9993980) or Intermediate stage (B)-Early stage (A)  (p=1), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in INR Values between Terminal stage (D)-Advanced stage (C) (p= 0.0222675) as well as between Terminal stage (D)-Early stage (A) (p=0.0411839) and Terminal stage (D)-Intermediate stage (B) (p=0.0218497).

 Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------
 
#2- Alfa-Fetoprotein (AFP):
     
```{r warning=FALSE, , echo=TRUE}

AFP_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(AFP, na.rm = T), sd = sd(AFP, na.rm = T)))
AFP_mean

hist(AFP)

ggplot(HCC, aes(x=AFP)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4") +
  scale_y_continuous(limits = c(0, 15)) +
  scale_x_continuous(limits = c(0, 2000)) 

  skewness(HCC$AFP)
  kurtosis(HCC$AFP)
  
  shapiro.test(AFP)

```

  Mean AFP of population of Intrest is 15882.19 and standard Deviation is 131117.5.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- AFP with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

AFP_status <- as.data.frame(HCC %>%
                 summary_factorlist("Status", "AFP", add_dependent_label = T, cont_cut = 1))

AFP_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(AFP, na.rm = TRUE),
    sd = sd(AFP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = AFP, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "AFP", fill = "Status") +
  ggtitle("Relation Between AFP Value and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "AFP", 
          color = "Status",
        ylab = "AFP", xlab = "Status") +
  scale_y_continuous(limits = c(0, 20000)) + 
   theme_economist()


  wilcox.test(AFP ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 1.497e-10, which is less than the significance level alpha = 0.05. We can conclude that Live patient average AFP Values is significantly different from Died patients average AFP Values with a p-value = 1.497e-10.
 
**B- AFP with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

AFP_symp <- as.data.frame(HCC %>%
                 summary_factorlist("Symptoms", "AFP", add_dependent_label = T, cont_cut = 1))

AFP_symp 

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(AFP, na.rm = TRUE),
    sd = sd(AFP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = AFP, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "AFP", fill = "Symptoms") +
  ggtitle("Relation Between AFP Value and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "AFP", 
          color = "Status",
        ylab = "AFP", xlab = "Status") +
  scale_y_continuous(limits = c(0, 20000)) + 
   theme_economist()

  wilcox.test(AFP ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.005585, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average AFP Values is significantly different from Asymptomatic patients average AFP Values with a p-value = 0.005585.
 
**C- AFP with Performance Status:

```{r warning=FALSE, , echo=TRUE}

AFP_PS <- as.data.frame(HCC %>%
                      summary_factorlist("PS", "AFP", add_dependent_label = T, cont_cut = 1))

AFP_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(AFP, na.rm = TRUE),
    sd = sd(AFP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = AFP, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "AFP", fill = "PS") +
  ggtitle("Relation Between AFP Value and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  scale_y_continuous(limits = c(0, 20000)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "PS", y = "AFP", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "AFP", xlab = "PS") +
  theme_economist()

AFP_PS_anova <- (aov(formula = AFP ~ PS, data = HCC))
summary(AFP_PS_anova)

kruskal.test(formula = AFP ~ PS, data = HCC)

```

In one-way ANOVA test, a significant p-value = 0.0601 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.00258 is less than the significance level 0.05,
we can conclude that there are significant differences between the groups.  

**D- AFP with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

AFP_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "AFP", add_dependent_label = T, cont_cut = 1))

AFP_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(AFP, na.rm = TRUE),
    sd = sd(AFP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = AFP, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "AFP", fill = "HCC_Stages") +
  ggtitle("Relation Between AFP Value and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  scale_y_continuous(limits = c(0, 20000)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "HCC_Stages", y = "AFP", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "AFP", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

AFP_Stages_anova <- (aov(formula = AFP ~ HCC_Stages, data = HCC))
summary(AFP_Stages_anova)

kruskal.test(formula = AFP ~ HCC_Stages, data = HCC)
```

In one-way ANOVA test, a significant p-value = 0.229 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.001687 is less than the significance level 0.05,
we can conclude that there are significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

#3- Hemoglobin:
     
```{r warning=FALSE, , echo=TRUE}

Hemoglobin_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Hemoglobin, na.rm = T), sd = sd(Hemoglobin, na.rm = T)))
Hemoglobin_mean

hist(Hemoglobin)

ggplot(HCC, aes(x=Hemoglobin)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$Hemoglobin)
  kurtosis(HCC$Hemoglobin)
  
  shapiro.test(Hemoglobin)

```

  Mean Hemoglobin value in population of Intrest is 12.72 and standard Deviation is 2.18.
  
  The Distribution is highly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values= 0.5312 > the significance level 0.05, implying that the distribution of the data are significantly not different from the normal distribution. 
In other words, we can assume the normality, Normally Distributed.
We will use t.test.

**A- Hemoglobin with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Hemoglobin_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Hemoglobin", add_dependent_label = T, cont_cut = 1))

Hemoglobin_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Hemoglobin, na.rm = TRUE),
    sd = sd(Hemoglobin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = Hemoglobin, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Hemoglobin", fill = "Status") +
  ggtitle("Relation Between Hemoglobin Value and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Hemoglobin", 
          color = "Status",
        ylab = "Hemoglobin", xlab = "Status") +
   theme_economist()


  t.test(Hemoglobin ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the t-test is 1.402e-05, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Hemoglobin Values is significantly different from Died patients average Hemoglobin Values with a p-value = 1.402e-05.
 
**B- Hemoglobin with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Hemo_symp <- as.data.frame(HCC %>%
                                        summary_factorlist("Symptoms", "Hemoglobin", add_dependent_label = T, cont_cut = 1))

Hemo_symp 

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Hemoglobin, na.rm = TRUE),
    sd = sd(Hemoglobin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Hemoglobin, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Hemoglobin", fill = "Symptoms") +
  ggtitle("Relation Between Hemoglobin Value and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Hemoglobin", 
          color = "Symptoms",
        ylab = "Hemoglobin", xlab = "Status") +
   theme_economist()

  t.test(Hemoglobin ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.03953, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Hemoglobin Vlaues is significantly different from Asymptomatic patients average Hemoglobin Values with a p-value = 0.03953.
 
**C- Hemoglobin with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Hemo_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Hemoglobin", add_dependent_label = T, cont_cut = 1))

Hemo_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Hemoglobin, na.rm = TRUE),
    sd = sd(Hemoglobin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Hemoglobin, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Hemoglobin", fill = "PS") +
  ggtitle("Relation Between Hemoglobin Value and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Hemoglobin", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Hemoglobin", xlab = "PS") +
  theme_economist()

Hemo_PS_anova <- (aov(formula = Hemoglobin ~ PS, data = HCC))
summary(Hemo_PS_anova)
TukeyHSD(Hemo_PS_anova)
plot(TukeyHSD(Hemo_PS_anova))

```

 In one-way ANOVA test, a significant p-value = 8.52e-08 indicates that significant relationship between INR and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Hemoglobin Values from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Hemoglobin Values between:
Disabled-Active ( p = 0.9909041 > 0.05), as well as between West Disabled-Ambulatory (p=0.7828994) or Restricted-Ambulatory (p=0.9987224), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Hemoglobin Values between Ambulatory-Active (p= 0.0042626) as well as between Restricted-Active (p=0.0063161) and Selfcare-Active (p=0.0000001).

 Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Hemoglobin with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Hemo_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Hemoglobin", add_dependent_label = T, cont_cut = 1))

Hemo_Stages 

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Hemoglobin, na.rm = TRUE),
    sd = sd(Hemoglobin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Hemoglobin, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Hemoglobin", fill = "HCC_Stages") +
  ggtitle("Relation Between Hemoglobin Value and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Hemoglobin", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Hemoglobin", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Hemo_Stages_anova <- (aov(formula = Hemoglobin ~ HCC_Stages, data = HCC))
summary(Hemo_Stages_anova)
TukeyHSD(Hemo_Stages_anova)
plot(TukeyHSD(Hemo_Stages_anova))

```

 In one-way ANOVA test, a significant p-value = 0.0242 indicates that significant relationship between INR and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Hemoglobin Values from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Hemoglobin Values between:
Early stage (A)-Advanced stage (C) ( p = 0.6984742 > 0.05), as well as between Intermediate stage (B)-Advanced stage (C) (p=0.7919431) or Terminal stage (D)-Advanced stage (C) (p=0.3068353), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Hemoglobin Values between Terminal stage (D)-Early stage (A) (p= 0.0375973) as well as between Terminal stage (D)-Intermediate stage (B) (p=0.0407807).

 Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------

#4- Mean Curpascular Volume (MCV):

```{r warning=FALSE, , echo=TRUE}

MCV_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(MCV, na.rm = T), sd = sd(MCV, na.rm = T)))
MCV_mean

hist(MCV)

ggplot(HCC, aes(x=MCV)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$MCV)
  kurtosis(HCC$MCV)
  
  shapiro.test(MCV)

```

  Mean MCV Values in population of Intrest is 94.82 and standard Deviation is 8.167.
  
  The Distribution is moderatly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
From the output, the p-values= 0.0552 > the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- MCV with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

MCV_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "MCV", add_dependent_label = T, cont_cut = 1))

MCV_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(MCV, na.rm = TRUE),
    sd = sd(MCV, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Status, y = MCV, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "MCV", fill = "Status") +
  ggtitle("Relation Between MCV Value and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "MCV", 
          color = "Status",
        ylab = "MCV", xlab = "Status") +
   theme_economist()

  wilcox.test(MCV ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.3072, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average MCV Values is not significantly different from Died patients average MCV Values with a p-value = 0.3072.
 
**B- MCV with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

MCV_symp <- as.data.frame(HCC %>%
                                        summary_factorlist("Symptoms", "MCV", add_dependent_label = T, cont_cut = 1))

MCV_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(MCV, na.rm = TRUE),
    sd = sd(MCV, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = MCV, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "MCV", fill = "Symptoms") +
  ggtitle("Relation Between MCV Value and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "MCV", 
          color = "Symptoms",
        ylab = "MCV", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(MCV ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

```

  The p-value of the Wilcoxon rank sum test is 0.03688, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average MCV Values is not significantly different from Asymptomatic patients average MCV Values with a p-value = 0.03688.
  
**C- MCV with Performance Status:

```{r warning=FALSE, , echo=TRUE}

MCV_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "MCV", add_dependent_label = T, cont_cut = 1))

MCV_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(MCV, na.rm = TRUE),
    sd = sd(MCV, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = MCV, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "MCV", fill = "PS") +
  ggtitle("Relation Between MCV Value and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "MCV", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "MCV", xlab = "PS") +
  theme_economist()

MCV_PS_anova <- (aov(formula = MCV ~ PS, data = HCC))
summary(MCV_PS_anova)

kruskal.test(formula = MCV ~ PS, data = HCC)

```

 In one-way ANOVA test, a significant p-value = 0.387 indicates that no different in the group means.  
  
 In Kruskal-Wallis rank sum test, the p-value = 0.5966 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- MCV with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

MCV_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "MCV", add_dependent_label = T, cont_cut = 1))

MCV_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(MCV, na.rm = TRUE),
    sd = sd(MCV, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = MCV, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "MCV", fill = "HCC_Stages") +
  ggtitle("Relation Between MCV Value and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "MCV", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "MCV", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

MCV_Stages_anova <- (aov(formula = MCV ~ HCC_Stages, data = HCC))
summary(MCV_Stages_anova)

kruskal.test(formula = MCV ~ HCC_Stages, data = HCC)

```

 In one-way ANOVA test, a significant p-value = 0.0856 indicates that no different in the group means.  
  
 In Kruskal-Wallis rank sum test, the p-value = 0.04254 is less than the significance level 0.05,
we can conclude that there are significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

#5- Leucocytic Count:
     
```{r warning=FALSE, , echo=TRUE}

Leucocytes_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Leucocytes, na.rm = T), sd = sd(Leucocytes, na.rm = T)))
Leucocytes_mean

hist(Leucocytes)

ggplot(HCC, aes(x=Leucocytes)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

  skewness(HCC$Leucocytes)
  kurtosis(HCC$Leucocytes)
  
  shapiro.test(Leucocytes)

```

  Mean Leucocytic count in population of Intrest is 1500.309 and standard Deviation is 2804.765.
  
  The Distribution is highly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
  From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
We will use Wilcoxon rank test.

**A- Leucocytic Count with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Leucocytes_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Leucocytes", add_dependent_label = T, cont_cut = 1))

Leucocytes_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Leucocytes, na.rm = TRUE),
    sd = sd(Leucocytes, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Leucocytes, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Leucocytes", fill = "Status") +
  ggtitle("Relation Between Leucocytes Value and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Leucocytes", 
          color = "Status",
        ylab = "Leucocytes", xlab = "Status") +
   theme_economist()

  wilcox.test(Leucocytes ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.01879, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Leucocytic count is significantly different from Died patients average Leucocytic count with a p-value = 0.01879.
 
**B- Leucocytic Count with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Leucocytes_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Leucocytes", add_dependent_label = T, cont_cut = 1))

Leucocytes_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Leucocytes, na.rm = TRUE),
    sd = sd(Leucocytes, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Leucocytes, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Leucocytes", fill = "Symptoms") +
  ggtitle("Relation Between Leucocytes Value and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Leucocytes", 
          color = "Symptoms",
        ylab = "Leucocytes", xlab = "Symptoms") +
   theme_economist()


  wilcox.test(Leucocytes ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.06718, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Leucocytic count is not significantly different from Asymptomatic patients average Leucocytic count with a p-value = 0.06718.
 
  
**C- Leucocytic Count with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Leucocytes_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Leucocytes", add_dependent_label = T, cont_cut = 1))

Leucocytes_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Leucocytes, na.rm = TRUE),
    sd = sd(Leucocytes, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Leucocytes, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Leucocytes", fill = "PS") +
  ggtitle("Relation Between Leucocytic Counts and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Leucocytes", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Leucocytes", xlab = "PS") +
  theme_economist()

Leucocytes_PS_anova <- (aov(formula = Leucocytes ~ PS, data = HCC))
summary(Leucocytes_PS_anova)

kruskal.test(formula = Leucocytes ~ PS, data = HCC)

```

 In one-way ANOVA test, a significant p-value = 0.159 indicates that no different in the group means.  
  
 In Kruskal-Wallis rank sum test, the p-value = 0.216 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Leucocytic Count with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Leucocytes_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Leucocytes", add_dependent_label = T, cont_cut = 1))

Leucocytes_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Leucocytes, na.rm = TRUE),
    sd = sd(Leucocytes, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Leucocytes, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Leucocytes", fill = "HCC_Stages") +
  ggtitle("Relation Between Leucocytic Count and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Leucocytes", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Leucocytes", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Leucocytes_Stages_anova <- (aov(formula = MCV ~ HCC_Stages, data = HCC))
summary(Leucocytes_Stages_anova)

kruskal.test(formula = Leucocytes ~ HCC_Stages, data = HCC)

```

 In one-way ANOVA test, a significant p-value = 0.0856 indicates that no different in the group means.  
  
 In Kruskal-Wallis rank sum test, the p-value = 0.005898 is less than the significance level 0.05,
we can conclude that there are significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 6- Albumin Level:
     
```{r warning=FALSE, , echo=TRUE}

Albumin_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Albumin, na.rm = T), sd = sd(Albumin, na.rm = T)))
Albumin_mean


hist(Albumin)

ggplot(HCC, aes(x=Albumin)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

    boxplot(Albumin ~ Status, data = HCC, xlab = "Status", ylab = "Albumin Level",
            main = "Relation Between Albumin Level and Starus of Patients")
  
  skewness(HCC$Albumin)
  kurtosis(HCC$Albumin)
  
  shapiro.test(Albumin)

```

  Mean Albumin Levels of population of Intrest is 3.42 and standard Deviation is 0.65.
  
  The Distribution is moderatly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values= 0.07684 > the significance level 0.05, implying that the distribution of the data are not significantly different from the normal distribution. 
In other words, we can assume the normality, Normally Distributed.
We will use t.test.

**A- Albumin Levels with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Albumin_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Albumin", add_dependent_label = T, cont_cut = 1))

Albumin_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Albumin, na.rm = TRUE),
    sd = sd(Albumin, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Albumin, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Albumin", fill = "Status") +
  ggtitle("Relation Between Albumin levels and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Albumin", 
          color = "Status",
        ylab = "Albumin", xlab = "Status") +
   theme_economist()

  t.test(Albumin ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the t.test is 6.68e-05, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Albumin Levels is significantly different from Died patients average Albumin Levels with a p-value = 6.68e-05.
 
**B- Albumin Levels with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Albumin_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Albumin", add_dependent_label = T, cont_cut = 1))

Albumin_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Albumin, na.rm = TRUE),
    sd = sd(Albumin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Albumin, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Albumin", fill = "Symptoms") +
  ggtitle("Relation Between Albumin levels and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Albumin", 
          color = "Symptoms",
        ylab = "Albumin", xlab = "Symptoms") +
   theme_economist()


  t.test(Albumin ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)

  wilcox.test(Albumin ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the t.test is 0.0609, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Albumin levels is not significantly different from Asymptomatic patients average Albumin levels with a p-value = 0.0609.

 The p-value of the Wilcoxon rank sum test is 0.06077, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Albumin levels is not significantly different from Asymptomatic patients average Albumin levels with a p-value = 0.06077. 
 
**C- Albumin Levels with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Albumin_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Albumin", add_dependent_label = T, cont_cut = 1))

Albumin_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Albumin, na.rm = TRUE),
    sd = sd(Albumin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Albumin, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Leucocytes", fill = "PS") +
  ggtitle("Relation Between Albumin levels and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Albumin", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Albumin", xlab = "PS") +
  theme_economist()

Albumin_PS_anova <- (aov(formula = Albumin ~ PS, data = HCC))
summary(Albumin_PS_anova)
TukeyHSD(Albumin_PS_anova)
plot(TukeyHSD(Albumin_PS_anova))

```
  
 In one-way ANOVA test, a significant p-value = 2.26e-08 indicates that significant relationship between Albumin levels and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in Albumin levels from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Albumin levels between:
Disabled-Ambulatory ( p =0.5006588 > 0.05), as well as between Restricted-Ambulatory (p=0.9995302) or Selfcare-Ambulatory   (p=0.9681129), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Albumin levels between Ambulatory-Active (p= 0.0001720) as well as between Disabled-Active (p=0.0024840) and Restricted-Active (p=0.0001646) and Selfcare-Active (p=0.0000353).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Albumin Levels with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Albumin_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Albumin", add_dependent_label = T, cont_cut = 1))

Albumin_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Albumin, na.rm = TRUE),
    sd = sd(Albumin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Albumin, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Albumin", fill = "HCC_Stages") +
  ggtitle("Relation Between Albumin levels and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Albumin", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Albumin", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Albumin_Stages_anova <- (aov(formula = Albumin ~ HCC_Stages, data = HCC))
summary(Albumin_Stages_anova)
TukeyHSD(Albumin_Stages_anova)
plot(TukeyHSD(Albumin_Stages_anova))

```
  
 In one-way ANOVA test, a significant p-value = 1.3e-07 indicates that significant relationship between Albumin levels and HCC Stages (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in Albumin levels and HCC Stages. So, We can conclude that:

1- There is no significant difference in Albumin level between:
Very early stage-Advanced stage (C) ( p =0.9587808 > 0.05), as well as between Intermediate stage (B)-Early stage (A)     (p=0.9999992) or Very early stage-Early stage (A)           (p=0.9993789), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Albumin level between Early stage (A)-Advanced stage (C) (p= 0.0368966) as well as between Intermediate stage (B)-Advanced stage (C) (p= 0.0144255) and Terminal stage (D)-Advanced stage (C) (p= 0.0300929) and Terminal stage (D)-Early stage (A) (p= 0.0000056) and Terminal stage (D)-Intermediate stage (B) (p= 0.0000006).

 Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------

# 7- Platelet Count:
     
```{r warning=FALSE, , echo=TRUE}

Platelets_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Platelets, na.rm = T), sd = sd(Platelets, na.rm = T)))
Platelets_mean


hist(Platelets)

ggplot(HCC, aes(x=Platelets)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")

    boxplot(Platelets ~ Status, data = HCC, xlab = "Status", ylab = "Platelets Count",
            main = "Relation Between Platelets Count and Starus of Patients")
  
  skewness(HCC$Platelets)
  kurtosis(HCC$Platelets)
  
  shapiro.test(Platelets)

```

  Mean Platelets Count of population of Intrest is 116677.5 and standard Deviation is 107643.4.
  
  The Distribution is Highly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values= 1.879e-10 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Platelet Count with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Platelets_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Platelets", add_dependent_label = T, cont_cut = 1))

Platelets_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Platelets, na.rm = TRUE),
    sd = sd(Platelets, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Platelets, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Platelets", fill = "Status") +
  ggtitle("Relation Between Platelets Counts and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Platelets", 
          color = "Status",
        ylab = "Platelets", xlab = "Status") +
   theme_economist()

  wilcox.test(Platelets ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.05885, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average Platelet Count is not significantly different from Died patients average Platelet Count with a p-value = 0.05885.
 
**B- Platelet Count with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Platelets_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Platelets", add_dependent_label = T, cont_cut = 1))

Platelets_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Platelets, na.rm = TRUE),
    sd = sd(Platelets, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Platelets, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Platelets", fill = "Symptoms") +
  ggtitle("Relation Between Platelets Counts and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Platelets", 
          color = "Symptoms",
        ylab = "Platelets", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Platelets ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.000757, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Platelet Count is significantly different from Asymptomatic patients average Platelet Count with a p-value = 0.000757.

**C- Platelet Count with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Platelets_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Platelets", add_dependent_label = T, cont_cut = 1))

Platelets_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Platelets, na.rm = TRUE),
    sd = sd(Platelets, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Platelets, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Platelets", fill = "PS") +
  ggtitle("Relation Between Platelets Counts and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Platelets", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Platelets", xlab = "PS") +
  theme_economist()

Platelet_PS_anova <- (aov(formula = Platelets ~ PS, data = HCC))
summary(Platelet_PS_anova)
TukeyHSD(Platelet_PS_anova)
plot(TukeyHSD(Platelet_PS_anova))

```
  
 In one-way ANOVA test, a significant p-value = 0.00886 indicates that significant relationship between Platelets Count and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in Platelets Count from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Platelets Count between:
Ambulatory-Active ( p =0.9718736 > 0.05), as well as between Restricted-Active (p=0.9422223) or Selfcare-Active   (p=0.8104124), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Platelets Count between Disabled-Active (p= 0.0096944) as well as between Disabled-Ambulatory (p=0.0337178) and Restricted-Disabled (p=0.0346767) and Selfcare-Disabled (p=0.0032316).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Platelets Count with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Platelets_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Platelets", add_dependent_label = T, cont_cut = 1))

Platelets_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Platelets, na.rm = TRUE),
    sd = sd(Platelets, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Platelets, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Platelets", fill = "HCC_Stages") +
  ggtitle("Relation Between Platelets Cpunts and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Platelets", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Platelets", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Platelets_Stages_anova <- (aov(formula = Platelets ~ HCC_Stages, data = HCC))
summary(Platelets_Stages_anova)
kruskal.test(formula = Platelets ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.241 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.08924 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 8- Total Bilirubin Level:
     
```{r warning=FALSE, , echo=TRUE}

Total_Bil_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Total_Bil, na.rm = T), sd = sd(Total_Bil, na.rm = T)))
Total_Bil_mean


hist(Total_Bil)

ggplot(HCC, aes(x=Total_Bil)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Total_Bil)
  kurtosis(HCC$Total_Bil)
  
  shapiro.test(Total_Bil)

```

  Mean Total Bilirubin Levels of population of Intrest is 3.165 and standard Deviation is 5.85.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Total Bilirubin Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Total_Bil_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Total_Bil", add_dependent_label = T, cont_cut = 1))

Total_Bil_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Total_Bil, na.rm = TRUE),
    sd = sd(Total_Bil, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Total_Bil, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Total_Bil", fill = "Status") +
  ggtitle("Relation Between Total Bilirubin Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Total_Bil", 
          color = "Status",
        ylab = "Total_Bil", xlab = "Status") +
   theme_economist()

  wilcox.test(Total_Bil ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.003445, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Total Bilirubin Level is significantly different from Died patients average Total Bilirubin Level with a p-value = 0.003445.
 
**B- Total Bilirubin Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Total_Bil_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Total_Bil", add_dependent_label = T, cont_cut = 1))

Total_Bil_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Total_Bil, na.rm = TRUE),
    sd = sd(Total_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Total_Bil, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Total_Bil", fill = "Symptoms") +
  ggtitle("Relation Between Total Bilirubin Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Total_Bil", 
          color = "Symptoms",
        ylab = "Total_Bil", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Total_Bil ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.2711, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Total Bilirubin Level is not significantly different from Asymptomatic patients average Total Bilirubin Level with a p-value = 0.2711.

**C- Total Bilirubin Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Total_Bil_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Total_Bil", add_dependent_label = T, cont_cut = 1))

Total_Bil_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Total_Bil, na.rm = TRUE),
    sd = sd(Total_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Total_Bil, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Total_Bil", fill = "PS") +
  ggtitle("Relation Between Total Bilirubin Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Total_Bil", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Total_Bil", xlab = "PS") +
  theme_economist()

Total_Bil_PS_anova <- (aov(formula = Total_Bil ~ PS, data = HCC))
summary(Total_Bil_PS_anova)
TukeyHSD(Total_Bil_PS_anova)
plot(TukeyHSD(Total_Bil_PS_anova))

```
  
 In one-way ANOVA test, a significant p-value = 7.72e-10 indicates that significant relationship between Total Bilirubin Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in Total Bilirubin Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Total Bilirubin Level between:
Ambulatory-Active ( p =0.4973373 > 0.05), as well as between Restricted-Active (p=0.6843280) or Selfcare-Active (p=0.9130118), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Total Bilirubin Level between Disabled-Active (p= 0) as well as between Disabled-Ambulatory (p=0) and Restricted-Disabled (p=0) and Selfcare-Disabled (p=0).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Total Bilirubin Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Total_Bil_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Total_Bil", add_dependent_label = T, cont_cut = 1))

Total_Bil_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Total_Bil, na.rm = TRUE),
    sd = sd(Total_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Total_Bil, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Total_Bil", fill = "HCC_Stages") +
  ggtitle("Relation Between Total Bilirubin Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Total_Bil", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Total_Bil", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Total_Bil_Stages_anova <- (aov(formula = Total_Bil ~ HCC_Stages, data = HCC))
summary(Total_Bil_Stages_anova)
TukeyHSD(Total_Bil_Stages_anova)
plot(TukeyHSD(Total_Bil_Stages_anova))
```
  
 In one-way ANOVA test, a significant p-value = 1.03e-07 indicates that significant relationship between Total Bilirubin Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in Total Bilirubin Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Total Bilirubin Level between:
Early stage (A)-Advanced stage (C) ( p =0.9998560 > 0.05), as well as between Intermediate stage (B)-Advanced stage (C) (p=0.9999089) or Very early stage-Advanced stage (C) (p=0.9996157), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Total Bilirubin Level between Terminal stage (D)-Advanced stage (C) (p= 0.0000007) as well as between Terminal stage (D)-Early stage (A) (p=0.0000128) and Terminal stage (D)-Intermediate stage (B) (p=0.0000023).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------

# 9- Alanin Transaminase Level (ALT):

```{r warning=FALSE, , echo=TRUE}

ALT_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(ALT, na.rm = T), sd = sd(ALT, na.rm = T)))
ALT_mean


hist(ALT)

ggplot(HCC, aes(x=ALT)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$ALT)
  kurtosis(HCC$ALT)
  
  shapiro.test(ALT)

```

  Mean ALT Levels of population of Intrest is 66.37 and standard Deviation is 52.97.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- ALT Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

ALT_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "ALT", add_dependent_label = T, cont_cut = 1))

ALT_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(ALT, na.rm = TRUE),
    sd = sd(ALT, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = ALT, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "ALT", fill = "Status") +
  ggtitle("Relation Between ALT Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "ALT", 
          color = "Status",
        ylab = "ALT", xlab = "Status") +
   theme_economist()

  wilcox.test(ALT ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.1304, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average ALT Level is not significantly different from Died patients average ALT Level with a p-value = 0.1304.
 
**B- ALT Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

ALT_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "ALT", add_dependent_label = T, cont_cut = 1))

ALT_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(ALT, na.rm = TRUE),
    sd = sd(ALT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = ALT, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "ALT", fill = "Symptoms") +
  ggtitle("Relation Between ALT Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "ALT", 
          color = "Symptoms",
        ylab = "ALT", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(ALT ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.6486, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average ALT Level is not significantly different from Asymptomatic patients average ALT Level with a p-value = 0.6486.

**C- ALT Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

ALT_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "ALT", add_dependent_label = T, cont_cut = 1))

ALT_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(ALT, na.rm = TRUE),
    sd = sd(ALT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = ALT, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "ALT", fill = "PS") +
  ggtitle("Relation Between ALT Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "ALT", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "ALT", xlab = "PS") +
  theme_economist()

ALT_PS_anova <- (aov(formula = ALT ~ PS, data = HCC))
summary(ALT_PS_anova)
kruskal.test(formula = ALT ~ PS, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.522 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.6943 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- ALT Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

ALT_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "ALT", add_dependent_label = T, cont_cut = 1))

ALT_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(ALT, na.rm = TRUE),
    sd = sd(ALT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = ALT, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "ALT", fill = "HCC_Stages") +
  ggtitle("Relation Between ALT Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "ALT", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "ALT", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

ALT_Stages_anova <- (aov(formula = ALT ~ HCC_Stages, data = HCC))
summary(ALT_Stages_anova)

kruskal.test(formula = ALT ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.802 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.9862 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 10- Gamma Glutamyl transferase Level (GGT):

```{r warning=FALSE, , echo=TRUE}

GGT_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(GGT, na.rm = T), sd = sd(GGT, na.rm = T)))
GGT_mean


hist(GGT)

ggplot(HCC, aes(x=GGT)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$GGT)
  kurtosis(HCC$GGT)
  
  shapiro.test(GGT)

```

  Mean GGT Levels of population of Intrest is 271.4 and standard Deviation is 251.68.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values = 1.451e-15 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- GGT Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

GGT_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "GGT", add_dependent_label = T, cont_cut = 1))

GGT_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(GGT, na.rm = TRUE),
    sd = sd(GGT, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = GGT, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "GGT", fill = "Status") +
  ggtitle("Relation Between GGT Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "GGT", 
          color = "Status",
        ylab = "GGT", xlab = "Status") +
   theme_economist()

  wilcox.test(GGT ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.005974, which is less than the significance level alpha = 0.05. We can conclude that Live patient average GGT Level is significantly different from Died patients average GGT Level with a p-value = 0.005974.
 
**B- GGT Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

GGT_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "GGT", add_dependent_label = T, cont_cut = 1))

GGT_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(GGT, na.rm = TRUE),
    sd = sd(GGT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = GGT, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "GGT", fill = "Symptoms") +
  ggtitle("Relation Between GGT Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "GGT", 
          color = "Symptoms",
        ylab = "GGT", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(GGT ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.3106, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average GGT Level is not significantly different from Asymptomatic patients average GGT Level with a p-value = 0.3106.

**C- GGT Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

GGT_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "GGT", add_dependent_label = T, cont_cut = 1))

GGT_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(GGT, na.rm = TRUE),
    sd = sd(GGT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = GGT, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "GGT", fill = "PS") +
  ggtitle("Relation Between GGT Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "GGT", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "GGT", xlab = "PS") +
  theme_economist()

GGT_PS_anova <- (aov(formula = GGT ~ PS, data = HCC))
summary(GGT_PS_anova)
kruskal.test(formula = GGT ~ PS, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.159 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.1036 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- GGT Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

GGT_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "GGT", add_dependent_label = T, cont_cut = 1))

GGT_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(GGT, na.rm = TRUE),
    sd = sd(GGT, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = GGT, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "GGT", fill = "HCC_Stages") +
  ggtitle("Relation Between GGT Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "GGT", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "GGT", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

GGT_Stages_anova <- (aov(formula = GGT ~ HCC_Stages, data = HCC))
summary(GGT_Stages_anova)

kruskal.test(formula = GGT ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.176 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.2018 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 11- Aspartate Transaminase Level (AST):

```{r warning=FALSE, , echo=TRUE}

AST_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(AST, na.rm = T), sd = sd(AST, na.rm = T)))
AST_mean


hist(AST)

ggplot(HCC, aes(x=AST)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$AST)
  kurtosis(HCC$AST)
  
  shapiro.test(AST)

```

  Mean AST Levels of population of Intrest is 96.025 and standard Deviation is 81.64.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- AST Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

AST_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "AST", add_dependent_label = T, cont_cut = 1))

AST_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(AST, na.rm = TRUE),
    sd = sd(AST, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = AST, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "AST", fill = "Status") +
  ggtitle("Relation Between AST Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "AST", 
          color = "Status",
        ylab = "AST", xlab = "Status") +
   theme_economist()

  wilcox.test(AST ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 5.009e-05, which is less than the significance level alpha = 0.05. We can conclude that Live patient average AST Level is significantly different from Died patients average AST Level with a p-value = 5.009e-05.
 
**B- AST Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

AST_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "AST", add_dependent_label = T, cont_cut = 1))

AST_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(AST, na.rm = TRUE),
    sd = sd(AST, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = AST, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "AST", fill = "Symptoms") +
  ggtitle("Relation Between AST Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "AST", 
          color = "Symptoms",
        ylab = "AST", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(AST ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.07481, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average AST Level is not significantly different from Asymptomatic patients average AST Level with a p-value = 0.07481.

**C- AST Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

AST_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "AST", add_dependent_label = T, cont_cut = 1))

AST_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(AST, na.rm = TRUE),
    sd = sd(AST, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = AST, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "AST", fill = "PS") +
  ggtitle("Relation Between AST Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "AST", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "AST", xlab = "PS") +
  theme_economist()

AST_PS_anova <- (aov(formula = AST ~ PS, data = HCC))
summary(AST_PS_anova)
kruskal.test(formula = AST ~ PS, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.527 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.1099 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- AST Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

AST_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "AST", add_dependent_label = T, cont_cut = 1))

AST_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(AST, na.rm = TRUE),
    sd = sd(AST, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = AST, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "AST", fill = "HCC_Stages") +
  ggtitle("Relation Between AST Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "AST", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "AST", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

AST_Stages_anova <- (aov(formula = AST ~ HCC_Stages, data = HCC))
summary(AST_Stages_anova)

kruskal.test(formula = AST ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.288 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.02579 is less than the significance level 0.05,
we can conclude that there are Significant Differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 12- Alkaline Phosphatase Level (ALP):

```{r warning=FALSE, , echo=TRUE}

ALP_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(ALP, na.rm = T), sd = sd(ALP, na.rm = T)))
ALP_mean


hist(ALP)

ggplot(HCC, aes(x=ALP)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$ALP)
  kurtosis(HCC$ALP)
  
  shapiro.test(ALP)

```

  Mean ALP Levels of population of Intrest is 221.18 and standard Deviation is 168.85.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- ALP Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

ALP_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "ALP", add_dependent_label = T, cont_cut = 1))

ALP_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(ALP, na.rm = TRUE),
    sd = sd(ALP, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = ALP, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "ALP", fill = "Status") +
  ggtitle("Relation Between ALP Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "ALP", 
          color = "Status",
        ylab = "ALP", xlab = "Status") +
   theme_economist()

  wilcox.test(ALP ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 3.235e-08, which is less than the significance level alpha = 0.05. We can conclude that Live patient average ALP Level is significantly different from Died patients average ALP Level with a p-value = 3.235e-08.
 
**B- ALP Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

ALP_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "ALP", add_dependent_label = T, cont_cut = 1))

ALP_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(ALP, na.rm = TRUE),
    sd = sd(ALP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = ALP, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "ALP", fill = "Symptoms") +
  ggtitle("Relation Between ALP Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "ALP", 
          color = "Symptoms",
        ylab = "ALP", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(ALP ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.008251, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average ALP Level is significantly different from Asymptomatic patients average ALP Level with a p-value = 0.008251.

**C- ALP Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

ALP_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "ALP", add_dependent_label = T, cont_cut = 1))

ALP_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(ALP, na.rm = TRUE),
    sd = sd(ALP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = ALP, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "ALP", fill = "PS") +
  ggtitle("Relation Between ALP Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "ALP", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "ALP", xlab = "PS") +
  theme_economist()

ALP_PS_anova <- (aov(formula = ALP ~ PS, data = HCC))
summary(ALP_PS_anova)
TukeyHSD(ALP_PS_anova)
plot(TukeyHSD(ALP_PS_anova))

```
  
 In one-way ANOVA test, a significant p-value = 3.08e-06 indicates that significant relationship between ALP Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in ALP Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in ALP Level between:
Ambulatory-Active ( p =0.6186347 > 0.05), as well as between Selfcare-Active (p=0.8130815) or Disabled-Ambulatory (p=0.2576929), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in ALP Level between:
Disabled-Active (p= 0.0478006) as well as between Restricted-Active (p=0.0000022) and Restricted-Ambulatory  (p=0.0138774) and Selfcare-Restricted (p=0.0151997).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- ALP Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

ALP_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "ALP", add_dependent_label = T, cont_cut = 1))

ALP_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(ALP, na.rm = TRUE),
    sd = sd(ALP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = ALP, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "ALP", fill = "HCC_Stages") +
  ggtitle("Relation Between ALP Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "ALP", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "ALP", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

ALP_Stages_anova <- (aov(formula = ALP ~ HCC_Stages, data = HCC))
summary(ALP_Stages_anova)
TukeyHSD(ALP_Stages_anova)
plot(TukeyHSD(ALP_Stages_anova))

```
  
 In one-way ANOVA test, a significant p-value = 0.0189 indicates that significant relationship between ALP Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

 We can see which continents have significant differences in ALP Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in ALP Level between:
Intermediate stage (B)-Advanced stage (C) ( p =0.1093188 > 0.05), as well as between Terminal stage (D)-Advanced stage (C) (p=0.8123381) or Very early stage-Advanced stage (C) (p=0.6886481), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in ALP Level between:
Early stage (A)-Advanced stage (C) (p= 0.0232387).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------

# 13- Total Protein Level (TP):

```{r warning=FALSE, , echo=TRUE}

TP_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(TP, na.rm = T), sd = sd(TP, na.rm = T)))
TP_mean


hist(TP)

ggplot(HCC, aes(x=TP)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$TP)
  kurtosis(HCC$TP)
  
  shapiro.test(TP)

```

  Mean TP Levels of population of Intrest is 9.5 and standard Deviation is 13.09.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- TP Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

TP_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "TP", add_dependent_label = T, cont_cut = 1))

TP_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(TP, na.rm = TRUE),
    sd = sd(TP, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = TP, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "TP", fill = "Status") +
  ggtitle("Relation Between TP Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "TP", 
          color = "Status",
        ylab = "TP", xlab = "Status") +
  scale_y_continuous(limits = c(0, 10)) + 
   theme_economist()

  wilcox.test(TP ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.1133, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average TP Level is not significantly different from Died patients average TP Level with a p-value = 0.1133.
 
**B- TP Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

TP_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "TP", add_dependent_label = T, cont_cut = 1))

TP_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(TP, na.rm = TRUE),
    sd = sd(TP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = TP, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "TP", fill = "Symptoms") +
  ggtitle("Relation Between TP Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "TP", 
          color = "Symptoms",
        ylab = "TP", xlab = "Symptoms") +
  scale_y_continuous(limits = c(0, 10)) + 
   theme_economist()

  wilcox.test(TP ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.6726, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average TP Level is not significantly different from Asymptomatic patients average TP Level with a p-value = 0.6726.

**C- TP Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

TP_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "TP", add_dependent_label = T, cont_cut = 1))

TP_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(TP, na.rm = TRUE),
    sd = sd(TP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = TP, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "TP", fill = "PS") +
  ggtitle("Relation Between TP Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "TP", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "TP", xlab = "PS") +
  scale_y_continuous(limits = c(0, 10)) +
  theme_economist()

TP_PS_anova <- (aov(formula = TP ~ PS, data = HCC))
summary(TP_PS_anova)
kruskal.test(formula = TP ~ PS, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.189 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.0001789 is less than the significance level 0.05,
we can conclude that there are Significant Differences between the groups.

**D- TP Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

TP_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "TP", add_dependent_label = T, cont_cut = 1))

TP_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(TP, na.rm = TRUE),
    sd = sd(TP, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = TP, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "TP", fill = "HCC_Stages") +
  ggtitle("Relation Between TP Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "TP", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "TP", xlab = "HCC_Stages") +
  scale_y_continuous(limits = c(0, 10)) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

TP_Stages_anova <- (aov(formula = TP ~ HCC_Stages, data = HCC))
summary(TP_Stages_anova)

kruskal.test(formula = TP ~ HCC_Stages, data = HCC)
```
  
In one-way ANOVA test, a significant p-value = 0.47 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.0006808 is less than the significance level 0.05,
we can conclude that there are Significant Differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 14- Creatinin Level:

```{r warning=FALSE, , echo=TRUE}

Creatinin_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Creatinine, na.rm = T), sd = sd(Creatinine, na.rm = T)))
Creatinin_mean


hist(Creatinine)

ggplot(HCC, aes(x=Creatinine)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Creatinine)
  kurtosis(HCC$Creatinine)
  
  shapiro.test(Creatinine)

```

  Mean Creatinin Levels of population of Intrest is 1.138 and standard Deviation is 0.95.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Creatinin Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Creatinine_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Creatinine", add_dependent_label = T, cont_cut = 1))

Creatinine_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Creatinine, na.rm = TRUE),
    sd = sd(Creatinine, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Creatinine, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Creatinine", fill = "Status") +
  ggtitle("Relation Between Creatinin Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Creatinine", 
          color = "Status",
        ylab = "Creatinine", xlab = "Status") +
  scale_y_continuous(limits = c(0, 5)) + 
   theme_economist()

  wilcox.test(Creatinine ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.02217, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Creatinin Level is significantly different from Died patients average Creatinin Level with a p-value = 0.02217.
 
**B- Creatinin Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Creatinine_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Creatinine", add_dependent_label = T, cont_cut = 1))

Creatinine_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Creatinine, na.rm = TRUE),
    sd = sd(Creatinine, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Creatinine, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Creatinine", fill = "Symptoms") +
  ggtitle("Relation Between Creatinin Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Creatinine", 
          color = "Symptoms",
        ylab = "Creatinine", xlab = "Symptoms") +
  scale_y_continuous(limits = c(0, 3)) + 
   theme_economist()

  wilcox.test(Creatinine ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.3343, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Creatinin Level is not significantly different from Asymptomatic patients average Creatinin Level with a p-value = 0.3343.

**C- Creatinin Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Creatinine_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Creatinine", add_dependent_label = T, cont_cut = 1))

Creatinine_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Creatinine, na.rm = TRUE),
    sd = sd(Creatinine, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Creatinine, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Creatinine", fill = "PS") +
  ggtitle("Relation Between Creatinin Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Creatinine", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Creatinine", xlab = "PS") +
  scale_y_continuous(limits = c(0, 5)) +
  theme_economist()

Creatinine_PS_anova <- (aov(formula = Creatinine ~ PS, data = HCC))
summary(Creatinine_PS_anova)
TukeyHSD(Creatinine_PS_anova)
plot(TukeyHSD(Creatinine_PS_anova))

```
  
In one-way ANOVA test, a significant p-value = 0.00353 indicates that significant relationship between Creatinin level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Creatinin level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Creatinin level between:
Ambulatory-Active ( p =0.8903254 > 0.05), as well as between Restricted-Active (p=0.9999987) or Selfcare-Active (p=0.9697684), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Creatinin level between: Disabled-Active (p= 0.0024598) as well as between Restricted-Disabled (p=0.0039442) and Disabled-Ambulatory (p=0.0009584) Selfcare-Disabled (p=0.0141406).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Creatinin Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Creatinine_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Creatinine", add_dependent_label = T, cont_cut = 1))

Creatinine_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Creatinine, na.rm = TRUE),
    sd = sd(Creatinine, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Creatinine, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Creatinine", fill = "HCC_Stages") +
  ggtitle("Relation Between Creatinine Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Creatinine", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Creatinine", xlab = "HCC_Stages") +
  scale_y_continuous(limits = c(0, 2)) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Creatinine_Stages_anova <- (aov(formula = Creatinine ~ HCC_Stages, data = HCC))
summary(Creatinine_Stages_anova)

kruskal.test(formula = Creatinine ~ HCC_Stages, data = HCC)
```
  
In one-way ANOVA test, a significant p-value = 0.14 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.1648 is greater than the significance level 0.05,
we can conclude that there are no Significant Differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 15- Direct Bilirubin Level::

```{r warning=FALSE, , echo=TRUE}

Dir_Bil_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Dir_Bil, na.rm = T), sd = sd(Dir_Bil, na.rm = T)))
Dir_Bil_mean


hist(Dir_Bil)

ggplot(HCC, aes(x=Dir_Bil)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Dir_Bil)
  kurtosis(HCC$Dir_Bil)
  
  shapiro.test(Dir_Bil)

```

  Mean Direct Bilirubin Levels of population of Intrest is 1.74 and standard Deviation is 4.0059.
  
  The Distribution is highly Skewed, and Kurtosis is not in acceptable range for bieng normally distributed.
  
 From the output, the p-values < 2.2e-16 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Direct Bilirubin Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Dir_Bil_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Dir_Bil", add_dependent_label = T, cont_cut = 1))

Dir_Bil_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Dir_Bil, na.rm = TRUE),
    sd = sd(Dir_Bil, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Dir_Bil, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Dir_Bil", fill = "Status") +
  ggtitle("Relation Between Creatinin Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Dir_Bil", 
          color = "Status",
        ylab = "Dir_Bil", xlab = "Status") +
  scale_y_continuous(limits = c(0, 10)) + 
   theme_economist()

  wilcox.test(Dir_Bil ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.0005269, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Direct Bilirubin Level is significantly different from Died patients average Direct Bilirubin Level with a p-value = 0.0005269.
 
**B- Direct Bilirubin Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Dir_Bil_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Dir_Bil", add_dependent_label = T, cont_cut = 1))

Dir_Bil_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Dir_Bil, na.rm = TRUE),
    sd = sd(Dir_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Dir_Bil, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Dir_Bil", fill = "Symptoms") +
  ggtitle("Relation Between Direct Bilirubin Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Dir_Bil", 
          color = "Symptoms",
        ylab = "Dir_Bil", xlab = "Symptoms") +
  scale_y_continuous(limits = c(0, 3)) + 
   theme_economist()

  wilcox.test(Dir_Bil ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.5439, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Direct Bilirubin Level is not significantly different from Asymptomatic patients average Direct Bilirubin Level with a p-value = 0.5439.

**C- Direct Bilirubin Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Dir_Bil_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Dir_Bil", add_dependent_label = T, cont_cut = 1))

Dir_Bil_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Dir_Bil, na.rm = TRUE),
    sd = sd(Dir_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Dir_Bil, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Dir_Bil", fill = "PS") +
  ggtitle("Relation Between Direct Bilirubin Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Dir_Bil", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Dir_Bil", xlab = "PS") +
  scale_y_continuous(limits = c(0, 5)) +
  theme_economist()

Dir_Bil_PS_anova <- (aov(formula = Dir_Bil ~ PS, data = HCC))
summary(Dir_Bil_PS_anova)
TukeyHSD(Dir_Bil_PS_anova)
plot(TukeyHSD(Dir_Bil_PS_anova))

```
  
In one-way ANOVA test, a significant p-value = 8.12e-10 indicates that significant relationship between Direct Bilirubin Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Direct Bilirubin Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Direct Bilirubin Level between:
Ambulatory-Active ( p =0.3741039 > 0.05), as well as between Restricted-Active (p=0.6345990) or Selfcare-Active (p=0.9795199), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Direct Bilirubin Level between: 
Disabled-Active (p= 0) as well as between Disabled-Ambulatory (p=0) and Restricted-Disabled (p=0) and Selfcare-Disabled (p=0).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Direct Bilirubin Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Dir_Bil_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Dir_Bil", add_dependent_label = T, cont_cut = 1))

Dir_Bil_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Dir_Bil, na.rm = TRUE),
    sd = sd(Dir_Bil, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Dir_Bil, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Dir_Bil", fill = "HCC_Stages") +
  ggtitle("Relation Between Direct Bilirubin Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Dir_Bil", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Dir_Bil", xlab = "HCC_Stages") +
  scale_y_continuous(limits = c(0, 2)) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Dir_Bil_Stages_anova <- (aov(formula = Dir_Bil ~ HCC_Stages, data = HCC))
summary(Dir_Bil_Stages_anova)
TukeyHSD(Dir_Bil_Stages_anova)
plot(TukeyHSD(Dir_Bil_Stages_anova))

```
  
In one-way ANOVA test, a significant p-value = 4.33e-06 indicates that significant relationship between Direct Bilirubin Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Direct Bilirubin Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Direct Bilirubin Level between:
Early stage (A)-Advanced stage (C) ( p =0.9958457 > 0.05), as well as between Intermediate stage (B)-Advanced stage (C) (p=0.9999724) or Very early stage-Advanced stage (C) (p=0.9994815), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Direct Bilirubin Level between: 
Terminal stage (D)-Advanced stage (C) (p= 0.0000246) as well as between Terminal stage (D)-Early stage (A) (p=0.0000957) and Terminal stage (D)-Intermediate stage (B) (p=0.0000657).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

------------------------------------------------------------------------------------------------------------------------------------

# 16- Iron Level:

```{r warning=FALSE, , echo=TRUE}

Iron_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Iron, na.rm = T), sd = sd(Iron, na.rm = T)))
Iron_mean


hist(Iron)

ggplot(HCC, aes(x=Iron)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Iron)
  kurtosis(HCC$Iron)
  
  shapiro.test(Iron)

```

  Mean Iron Levels of population of Intrest is 87.46 and standard Deviation is 55.4.
  
  The Distribution is moderatly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values = 2.419e-08 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Iron Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Iron_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Iron", add_dependent_label = T, cont_cut = 1))

Iron_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Iron, na.rm = TRUE),
    sd = sd(Iron, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Iron, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Iron", fill = "Status") +
  ggtitle("Relation Between Iron Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Iron", 
          color = "Status",
        ylab = "Iron", xlab = "Status") +
   theme_economist()

  wilcox.test(Iron ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.7201, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average Iron Level is not significantly different from Died patients average Iron Level with a p-value = 0.7201.
 
**B- Iron Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Iron_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Iron", add_dependent_label = T, cont_cut = 1))

Iron_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Iron, na.rm = TRUE),
    sd = sd(Iron, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Iron, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Iron", fill = "Symptoms") +
  ggtitle("Relation Between Iron Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Iron", 
          color = "Symptoms",
        ylab = "Iron", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Iron ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.7375, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Iron Level is not significantly different from Asymptomatic patients average Iron Level with a p-value = 0.7375.

**C- Iron Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Iron_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Iron", add_dependent_label = T, cont_cut = 1))

Iron_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Iron, na.rm = TRUE),
    sd = sd(Iron, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Iron, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Iron", fill = "PS") +
  ggtitle("Relation Between Iron Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Iron", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Iron", xlab = "PS") +
  theme_economist()

Iron_PS_anova <- (aov(formula = Iron ~ PS, data = HCC))
summary(Iron_PS_anova)

kruskal.test(Iron ~ PS, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.238 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.3127 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Iron Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Iron_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Iron", add_dependent_label = T, cont_cut = 1))

Iron_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Iron, na.rm = TRUE),
    sd = sd(Iron, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Iron, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Iron", fill = "HCC_Stages") +
  ggtitle("Relation Between Iron Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Iron", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Iron", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Iron_Stages_anova <- (aov(formula = Iron ~ HCC_Stages, data = HCC))
summary(Iron_Stages_anova)

kruskal.test(Iron ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.316 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.3066 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

------------------------------------------------------------------------------------------------------------------------------------

# 17- Ferritin Level:

```{r warning=FALSE, , echo=TRUE}

Ferritin_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Ferritin, na.rm = T), sd = sd(Ferritin, na.rm = T)))
Ferritin_mean


hist(Ferritin)

ggplot(HCC, aes(x=Ferritin)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Ferritin)
  kurtosis(HCC$Ferritin)
  
  shapiro.test(Ferritin)

```

  Mean Ferritin Level of population of Intrest is 435.25 and standard Deviation is 440.4.
  
  The Distribution is highly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values = 3.56e-14 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Ferritin Level with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Ferritin_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Ferritin", add_dependent_label = T, cont_cut = 1))

Ferritin_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Ferritin, na.rm = TRUE),
    sd = sd(Ferritin, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Ferritin, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Ferritin", fill = "Status") +
  ggtitle("Relation Between Ferritin Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Ferritin", 
          color = "Status",
        ylab = "Ferritin", xlab = "Status") +
   theme_economist()

  wilcox.test(Ferritin ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 4.083e-07, which is less than the significance level alpha = 0.05. We can conclude that Live patient average Ferritin Level is significantly different from Died patients average Ferritin Level with a p-value = 4.083e-07.
 
**B- Ferritin Level with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Ferritin_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Ferritin", add_dependent_label = T, cont_cut = 1))

Ferritin_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Ferritin, na.rm = TRUE),
    sd = sd(Ferritin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Ferritin, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Ferritin", fill = "Symptoms") +
  ggtitle("Relation Between Ferritin Level and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Ferritin", 
          color = "Symptoms",
        ylab = "Ferritin", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Ferritin ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.01591, which is less than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Ferritin Level is significantly different from Asymptomatic patients average Ferritin Level with a p-value = 0.01591.

**C- Ferritin Level with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Ferritin_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Ferritin", add_dependent_label = T, cont_cut = 1))

Ferritin_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Ferritin, na.rm = TRUE),
    sd = sd(Ferritin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Ferritin, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Ferritin", fill = "PS") +
  ggtitle("Relation Between Ferritin Level and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Ferritin", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Ferritin", xlab = "PS") +
  theme_economist()

Ferritin_PS_anova <- (aov(formula = Ferritin ~ PS, data = HCC))
summary(Ferritin_PS_anova)
TukeyHSD(Ferritin_PS_anova)
plot(TukeyHSD(Ferritin_PS_anova))
```
  
In one-way ANOVA test, a significant p-value = 5.4e-08 indicates that significant relationship between Ferritin Level and Performance Status (NOT ALL THE MEANS ARE EQUAL).  

We can see which continents have significant differences in Ferritin Level from Different Peformance Status. So, We can conclude that:

1- There is no significant difference in Ferritin between:
Ambulatory-Active ( p =0.2783616 > 0.05), as well as between Restricted-Active (p=0.5040346) or Selfcare-Active     (p=0.5831685), etc.
2- THERE IS A SIGNIFICANT DIFFERENCE in Ferritin between: 
Disabled-Active (p= 0) as well as between Disabled-Ambulatory (p=0) and Restricted-Ambulatory (p=0.0210359) and Selfcare-Ambulatory (p=0.0400083) and Restricted-Disabled (p=0.0000362) and Selfcare-Disabled (p=0.0000818).

Finally, visualize continent pairs and analyse significant differences by plotting the the "TukeyHSD" object in R.
Significant differences are the ones which not cross the zero value.

**D- Ferritin Level with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Ferritin_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Ferritin", add_dependent_label = T, cont_cut = 1))

Ferritin_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Ferritin, na.rm = TRUE),
    sd = sd(Ferritin, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Ferritin, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Ferritin", fill = "HCC_Stages") +
  ggtitle("Relation Between Ferritin Level and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Ferritin", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Ferritin", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Ferritin_Stages_anova <- (aov(formula = Ferritin ~ HCC_Stages, data = HCC))
summary(Ferritin_Stages_anova)

kruskal.test(Ferritin ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.267 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.2533 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# 17- Oxygen Saturation:

```{r warning=FALSE, , echo=TRUE}

Sat_mean <- as.data.frame(HCC %>%
              summarise(count = n(), mean = mean(Sat, na.rm = T), sd = sd(Sat, na.rm = T)))
Sat_mean


hist(Sat)

ggplot(HCC, aes(x=Sat)) + 
  geom_histogram(aes(y=..count..), color = "black", fill="firebrick4")


  skewness(HCC$Sat)
  kurtosis(HCC$Sat)
  
  shapiro.test(Sat)

```

  Mean Sat Level of population of Intrest is 435.25 and standard Deviation is 440.4.
  
  The Distribution is highly Skewed, and Kurtosis is in acceptable range for bieng normally distributed.
  
 From the output, the p-values = 3.909e-10 < the significance level 0.05, implying that the distribution of the data are significantly different from the normal distribution. 
In other words, we cannot assume the normality, Not Normally Distributed.
 We will use Wilcoxon rank sum test.

**A- Oxygen Saturation with Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Sat_status <- as.data.frame(HCC %>%
                                        summary_factorlist("Status", "Sat", add_dependent_label = T, cont_cut = 1))

Sat_status

group_by(HCC, Status) %>%
  summarise(
    count = n(),
    mean = mean(Sat, na.rm = TRUE),
    sd = sd(Sat, na.rm = TRUE)
  )
  

ggplot(data = HCC, aes(x = Status, y = Sat, fill = Status)) +
  geom_col() +
  labs(x = "Status", y = "Sat", fill = "Status") +
  ggtitle("Relation Between Oxygen Saturation Level and Status of Patients") +
  scale_fill_discrete(name = "Status") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Status", y = "Sat", 
          color = "Status",
        ylab = "Sat", xlab = "Status") +
   theme_economist()

  wilcox.test(Sat ~ Status, mu=0, alternative = "two.sided", paired = FALSE)

```

 The p-value of the Wilcoxon rank sum test is 0.1636, which is greater than the significance level alpha = 0.05. We can conclude that Live patient average Oxygen Saturation is not significantly different from Died patients average Oxygen Saturation with a p-value = 0.1636.
 
**B- Oxygen Saturation with Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Sat_symp <- as.data.frame(HCC %>%
               summary_factorlist("Symptoms", "Sat", add_dependent_label = T, cont_cut = 1))

Sat_symp

group_by(HCC, Symptoms) %>%
  summarise(
    count = n(),
    mean = mean(Sat, na.rm = TRUE),
    sd = sd(Sat, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = Symptoms, y = Sat, fill = Symptoms)) +
  geom_col() +
  labs(x = "Symptoms", y = "Sat", fill = "Symptoms") +
  ggtitle("Relation Between Oxygen Saturation and Symptoms Appearance") +
  scale_fill_discrete(name = "Symptoms") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggboxplot(HCC, x = "Symptoms", y = "Sat", 
          color = "Symptoms",
        ylab = "Sat", xlab = "Symptoms") +
   theme_economist()

  wilcox.test(Sat ~ Symptoms, mu=0, alternative = "two.sided", paired = FALSE)
```

 The p-value of the Wilcoxon rank sum test is 0.2767, which is greater than the significance level alpha = 0.05. We can conclude that Symptomatic patient average Oxygen Saturation is not significantly different from Asymptomatic patients average Oxygen Saturation with a p-value = 0.2767.

**C- Oxygen Saturation with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Sat_PS <- as.data.frame(HCC %>%
                         summary_factorlist("PS", "Sat", add_dependent_label = T, cont_cut = 1))

Sat_PS

group_by(HCC, PS) %>%
  summarise(
    count = n(),
    mean = mean(Sat, na.rm = TRUE),
    sd = sd(Sat, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = PS, y = Sat, fill = PS)) +
  geom_col() +
  labs(x = "PS", y = "Sat", fill = "PS") +
  ggtitle("Relation Between Oxygen Saturation and Performance Status") +
  scale_fill_discrete(name = "PS") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
   
ggboxplot(HCC, x = "PS", y = "Sat", 
          color = "PS", 
          order = c("Active", "Ambulatory", "Disabled", "Restricted", "Selfcare"),
          ylab = "Sat", xlab = "PS") +
  theme_economist()

Sat_PS_anova <- (aov(formula = Sat ~ PS, data = HCC))
summary(Sat_PS_anova)
kruskal.test(formula = Sat ~ PS, data = HCC)
```
  
In one-way ANOVA test, a significant p-value = 0.795 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.8577 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**D- Oxygen Saturation with HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Sat_Stages <- as.data.frame(HCC %>%
               summary_factorlist("HCC_Stages", "Sat", add_dependent_label = T, cont_cut = 1))

Sat_Stages

group_by(HCC, HCC_Stages) %>%
  summarise(
    count = n(),
    mean = mean(Sat, na.rm = TRUE),
    sd = sd(Sat, na.rm = TRUE)
  )

ggplot(data = HCC, aes(x = HCC_Stages, y = Sat, fill = HCC_Stages)) +
  geom_col() +
  labs(x = "HCC_Stages", y = "Sat", fill = "HCC_Stages") +
  ggtitle("Relation Between Oxygen Saturation and HCC Stages") +
  scale_fill_discrete(name = "HCC_Stages") +
  scale_x_discrete(labels = abbreviate) +
  scale_y_continuous(limits = c(0, 90)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
ggboxplot(HCC, x = "HCC_Stages", y = "Sat", 
          color = "HCC_Stages", 
          order = c("Advanced stage (C)", "Early stage (A)", "Intermediate stage (B)", "Terminal stage (D)", "Very early stage"),
          ylab = "Sat", xlab = "HCC_Stages") +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5)) 

Sat_Stages_anova <- (aov(formula = Sat ~ HCC_Stages, data = HCC))
summary(Sat_Stages_anova)

kruskal.test(Sat ~ HCC_Stages, data = HCC)

```
  
In one-way ANOVA test, a significant p-value = 0.933 indicates that no different in the group means.  
  
In Kruskal-Wallis rank sum test, the p-value = 0.9494 is greater than the significance level 0.05,
we can conclude that there are no significant differences between the groups.

**********************************************************************************************************************************************************************************************************************************************************************************************
## Fifth: Analysis of Prognostic Factors:

#1- Relation Between Esophageal Varices and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Varices_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Varices, na.rm = T)))

Varices_sd

Count_Varices <- table(HCC$Varices)
Percent_Varices <- prop.table(Count_Varices)*100

Varices_persent <- as.data.frame(cbind(Count_Varices, Percent_Varices))
Varices_persent


ggplot(HCC,aes(Varices, fill= Varices)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Varices)

```

  SD of the Esophageal Varices population of Intrest is 0.483.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with HBeAg Positive are significantly commonly distributed with a p-value = 1.
 
**A- Varices with Status:

```{r warning=FALSE, , echo=TRUE}

Varices_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Varices", add_dependent_label = T, cont_cut = 1))
Varices_status

Count_Varices1 <- table(HCC$Varices, HCC$Status)
Percent_Varices1 <- prop.table(Count_Varices1)*100

Varices_persent1 <- as.data.frame(cbind(Count_Varices1, Percent_Varices1))
Varices_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Varices, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Varices, Status)

```

 p-value of chi.square is 1 > 0.05. So, this means there is no evidence to suggest that Patients with Esophageal Varices tends to have different Status.
 
**B- Varices with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Varices_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Varices", add_dependent_label = T,cont_cut = 1))
Varices_symptoms

Count_Varices2 <- table(HCC$Varices, HCC$Symptoms)
Percent_Varices2 <- prop.table(Count_Varices2)*100

Varices_persent2 <- as.data.frame(cbind(Count_Varices2, Percent_Varices2))
Varices_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Varices, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Varices, Symptoms) 
```

 p-value of chi.square is 0.03628 < 0.05. So, this means there is evidence to suggest that Patients with Esophageal Varices tends to have different Symptoms Appearance.
 
**C- Varices with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Varices_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Varices", add_dependent_label = T, cont_cut = 1))
Varices_PS

Count_Varices3 <- table(HCC$Varices, HCC$PS)
Percent_Varices3 <- prop.table(Count_Varices3)*100

Varices_persent3 <- as.data.frame(cbind(Count_Varices3, Percent_Varices3))
Varices_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Varices, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Varices, PS)
```

 p-value of chi.square is 0.01036 < 0.05. So, this means there is evidence to suggest that Patients with Esophageal Varices tends to have different Performance Status.
 
**D- Varices with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Varices_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Varices", add_dependent_label = T, cont_cut = 1))
Varices_Stages 


Count_Varices4 <- table(HCC$Varices, HCC$HCC_Stages)
Percent_Varices4 <- prop.table(Count_Varices4)*100

Varices_persent4 <- as.data.frame(cbind(Count_Varices4, Percent_Varices4))
Varices_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Varices, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Varices, HCC_Stages)

```

 p-value of chi.square is 0.0866 > 0.05. So, this means there is no evidence to suggest that Patients with Esophageal Varices tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#2- Relation Between Splenomegaly and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Spleno_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Spleno, na.rm = T)))

Spleno_sd

Count_Spleno <- table(HCC$Spleno)
Percent_Spleno <- prop.table(Count_Spleno)*100

Spleno_persent <- as.data.frame(cbind(Count_Spleno, Percent_Spleno))
Spleno_persent


ggplot(HCC,aes(Spleno, fill= Spleno)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Spleno)

```

  SD of the Splenomegaly population of Intrest is 0.5.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Splenomegaly are significantly commonly distributed with a p-value = 1.
 
**A- Splenomegaly with Status:

```{r warning=FALSE, , echo=TRUE}

Spleno_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Spleno", add_dependent_label = T, cont_cut = 1))
Spleno_status

Count_Spleno1 <- table(HCC$Spleno, HCC$Status)
Percent_Spleno1 <- prop.table(Count_Spleno1)*100

Spleno_persent1 <- as.data.frame(cbind(Count_Spleno1, Percent_Spleno1))
Spleno_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Spleno, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Spleno, Status)

```

 p-value of chi.square is 0.5745 > 0.05. So, this means there is no evidence to suggest that Patients with Splenomegaly tends to have different Status.
 
**B- Splenomegaly with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Spleno_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Spleno", add_dependent_label = T,cont_cut = 1))
Spleno_symptoms

Count_Spleno2 <- table(HCC$Spleno, HCC$Symptoms)
Percent_Spleno2 <- prop.table(Count_Spleno2)*100

Spleno_persent2 <- as.data.frame(cbind(Count_Spleno2, Percent_Spleno2))
Spleno_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Spleno, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Spleno, Symptoms) 
```

 p-value of chi.square is 0.799 > 0.05. So, this means there is no evidence to suggest that Patients with Splenomegaly tends to have different Symptoms Appearance.
 
**C- Splenomegaly with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Spleno_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Spleno", add_dependent_label = T, cont_cut = 1))
Spleno_PS

Count_Spleno3 <- table(HCC$Spleno, HCC$PS)
Percent_Spleno3 <- prop.table(Count_Spleno3)*100

Spleno_persent3 <- as.data.frame(cbind(Count_Varices3, Percent_Varices3))
Spleno_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Spleno, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Spleno, PS)
```

 p-value of chi.square is 0.3787 > 0.05. So, this means there is no evidence to suggest that Patients with Splenomegaly tends to have different Performance Status.
 
**D- Splenomegaly with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Spleno_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Spleno", add_dependent_label = T, cont_cut = 1))
Spleno_Stages 


Count_Spleno4 <- table(HCC$Spleno, HCC$HCC_Stages)
Percent_Spleno4 <- prop.table(Count_Spleno4)*100

Spleno_persent4 <- as.data.frame(cbind(Count_Spleno4, Percent_Spleno4))
Spleno_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Spleno, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Spleno, HCC_Stages)

```

 p-value of chi.square is 0.01731 < 0.05. So, this means there is evidence to suggest that Patients with Splenomegaly tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#3- Relation Between Portal Hypertension and Dependent Variables (PHT):
  
```{r warning=FALSE, , echo=TRUE}

PHT_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(PHT, na.rm = T)))

PHT_sd

Count_PHT <- table(HCC$PHT)
Percent_PHT <- prop.table(Count_PHT)*100

PHT_persent <- as.data.frame(cbind(Count_PHT, Percent_PHT))
PHT_persent


ggplot(HCC,aes(PHT, fill= PHT)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(PHT)

```

  SD of the Portal Hyprtension population of Intrest is 0.467.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with PHT are significantly commonly distributed with a p-value = 1.
 
**A- PHT with Status:

```{r warning=FALSE, , echo=TRUE}

PHT_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "PHT", add_dependent_label = T, cont_cut = 1))
PHT_status

Count_PHT1 <- table(HCC$PHT, HCC$Status)
Percent_PHT1 <- prop.table(Count_PHT1)*100

PHT_persent1 <- as.data.frame(cbind(Count_PHT1, Percent_PHT1))
PHT_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~PHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PHT, Status)

```

 p-value of chi.square is 1 > 0.05. So, this means there is no evidence to suggest that Patients with PHT tends to have different Status.
 
**B- PHT with Symptoms:

```{r warning=FALSE, , echo=TRUE}

PHT_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "PHT", add_dependent_label = T,cont_cut = 1))
PHT_symptoms

Count_PHT2 <- table(HCC$PHT, HCC$Symptoms)
Percent_PHT2 <- prop.table(Count_PHT2)*100

PHT_persent2 <- as.data.frame(cbind(Count_PHT2, Percent_PHT2))
PHT_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~PHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PHT, Symptoms) 
```

 p-value of chi.square is 0.6427 > 0.05. So, this means there is no evidence to suggest that Patients with PHT tends to have different Symptoms Appearance.
 
**C- PHT with Performance Status:

```{r warning=FALSE, , echo=TRUE}

PHT_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "PHT", add_dependent_label = T, cont_cut = 1))
PHT_PS

Count_PHT3 <- table(HCC$PHT, HCC$PS)
Percent_PHT3 <- prop.table(Count_PHT3)*100

PHT_persent3 <- as.data.frame(cbind(Count_PHT3, Percent_PHT3))
PHT_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~PHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PHT, PS)
```

 p-value of chi.square is 8.344e-05 < 0.05. So, this means there is evidence to suggest that Patients with PHT tends to have different Performance Status.
 
**D- PHT with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

PHT_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "PHT", add_dependent_label = T, cont_cut = 1))
PHT_Stages 


Count_PHT4 <- table(HCC$PHT, HCC$HCC_Stages)
Percent_PHT4 <- prop.table(Count_PHT4)*100

PHT_persent4 <- as.data.frame(cbind(Count_PHT4, Percent_PHT4))
PHT_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~PHT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PHT, HCC_Stages)

```

 p-value of chi.square is 0.0006669 < 0.05. So, this means there is evidence to suggest that Patients with PHT tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#4- Relation Between Portal Vein Thrombosis and Dependent Variables (PVT):
  
```{r warning=FALSE, , echo=TRUE}

PVT_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(PVT, na.rm = T)))

PVT_sd

Count_PVT <- table(HCC$PVT)
Percent_PVT <- prop.table(Count_PVT)*100

PVT_persent <- as.data.frame(cbind(Count_PVT, Percent_PVT))
PVT_persent


ggplot(HCC,aes(PVT, fill= PVT)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(PVT)

```

  SD of the Portal Vein Thrombosis population of Intrest is 0.416.

 The p-value of the test is 0.9901, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with PVT are significantly commonly distributed with a p-value = 0.9901.
 
**A- PVT with Status:

```{r warning=FALSE, , echo=TRUE}

PVT_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "PVT", add_dependent_label = T, cont_cut = 1))
PVT_status

Count_PVT1 <- table(HCC$PHT, HCC$Status)
Percent_PVT1 <- prop.table(Count_PVT1)*100

PVT_persent1 <- as.data.frame(cbind(Count_PVT1, Percent_PVT1))
PVT_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~PVT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PVT, Status)

```

 p-value of chi.square is 0.01808 < 0.05. So, this means there is evidence to suggest that Patients with PVT tends to have different Status.
 
**B- PVT with Symptoms:

```{r warning=FALSE, , echo=TRUE}

PVT_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "PVT", add_dependent_label = T,cont_cut = 1))
PVT_symptoms

Count_PVT2 <- table(HCC$PVT, HCC$Symptoms)
Percent_PVT2 <- prop.table(Count_PVT2)*100

PVT_persent2 <- as.data.frame(cbind(Count_PVT2, Percent_PVT2))
PVT_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~PVT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PVT, Symptoms) 
```

 p-value of chi.square is 0.108 > 0.05. So, this means there is no evidence to suggest that Patients with PVT tends to have different Symptoms Appearance.
 
**C- PVT with Performance Status:

```{r warning=FALSE, , echo=TRUE}

PVT_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "PVT", add_dependent_label = T, cont_cut = 1))
PVT_PS

Count_PVT3 <- table(HCC$PVT, HCC$PS)
Percent_PVT3 <- prop.table(Count_PVT3)*100

PVT_persent3 <- as.data.frame(cbind(Count_PVT3, Percent_PVT3))
PVT_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~PVT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PVT, PS)
```

 p-value of chi.square is 0.0002008 < 0.05. So, this means there is evidence to suggest that Patients with PVT tends to have different Performance Status.
 
**D- PVT with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

PVT_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "PVT", add_dependent_label = T, cont_cut = 1))
PVT_Stages 


Count_PVT4 <- table(HCC$PVT, HCC$HCC_Stages)
Percent_PVT4 <- prop.table(Count_PVT4)*100

PVT_persent4 <- as.data.frame(cbind(Count_PVT4, Percent_PVT4))
PVT_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~PVT, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(PVT, HCC_Stages)

```

 p-value of chi.square is 2.42e-07 < 0.05. So, this means there is evidence to suggest that Patients with PVT tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#5- Relation Between Metastasis and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Metastasis_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Metastasis, na.rm = T)))

Metastasis_sd

Count_Metastasis <- table(HCC$Metastasis)
Percent_Metastasis <- prop.table(Count_Metastasis)*100

Metastasis_persent <- as.data.frame(cbind(Count_Metastasis, Percent_Metastasis))
Metastasis_persent


ggplot(HCC,aes(Metastasis, fill= Metastasis)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Metastasis)

```

  SD of the Portal Vein Thrombosis population of Intrest is 0.434.

 The p-value of the test is 0.9964, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with PVT are significantly commonly distributed with a p-value = 0.9964.
 
**A- Metastasis with Status:

```{r warning=FALSE, , echo=TRUE}

Metastasis_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Metastasis", add_dependent_label = T, cont_cut = 1))
Metastasis_status

Count_Metastasis1 <- table(HCC$Metastasis, HCC$Status)
Percent_Metastasis1 <- prop.table(Count_Metastasis1)*100

Metastasis_persent1 <- as.data.frame(cbind(Count_Metastasis1, Percent_Metastasis1))
Metastasis_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Metastasis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Metastasis, Status)

```

 p-value of chi.square is 0.0003748 < 0.05. So, this means there is evidence to suggest that Patients with Metastasis tends to have different Status.
 
**B- Metastasis with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Metastasis_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Metastasis", add_dependent_label = T,cont_cut = 1))
Metastasis_symptoms

Count_Metastasis2 <- table(HCC$Metastasis, HCC$Symptoms)
Percent_Metastasis2 <- prop.table(Count_Metastasis2)*100

Metastasis_persent2 <- as.data.frame(cbind(Count_Metastasis2, Percent_Metastasis2))
Metastasis_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Metastasis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Metastasis, Symptoms) 
```

 p-value of chi.square is 0.001207 < 0.05. So, this means there is evidence to suggest that Patients with Metastasis tends to have different Symptoms Appearance.
 
**C- Metastasis with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Metastasis_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Metastasis", add_dependent_label = T, cont_cut = 1))
Metastasis_PS

Count_Metastasis3 <- table(HCC$Metastasis, HCC$PS)
Percent_Metastasis3 <- prop.table(Count_Metastasis3)*100

Metastasis_persent3 <- as.data.frame(cbind(Count_Metastasis3, Percent_Metastasis3))
Metastasis_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Metastasis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Metastasis, PS)
```

 p-value of chi.square is 9.558e-06 < 0.05. So, this means there is evidence to suggest that Patients with Metastasis tends to have different Performance Status.
 
**D- Metastasis with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Metastasis_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Metastasis", add_dependent_label = T, cont_cut = 1))
Metastasis_Stages 


Count_Metastasis4 <- table(HCC$Metastasis, HCC$HCC_Stages)
Percent_Metastasis4 <- prop.table(Count_Metastasis4)*100

Metastasis_persent4 <- as.data.frame(cbind(Count_Metastasis4, Percent_Metastasis4))
Metastasis_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Metastasis, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Metastasis, HCC_Stages)

```

 p-value of chi.square is 4.008e-09 < 0.05. So, this means there is evidence to suggest that Patients with Metastasis tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#6- Relation Between Radiological Hallmark and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Hallmark_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Hallmark, na.rm = T)))

Hallmark_sd

Count_Hallmark <- table(HCC$Hallmark)
Percent_Hallmark <- prop.table(Count_Hallmark)*100

Hallmark_persent <- as.data.frame(cbind(Count_Hallmark, Percent_Hallmark))
Hallmark_persent


ggplot(HCC,aes(Hallmark, fill= Hallmark)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Hallmark)

```

  SD of the Portal Vein Thrombosis population of Intrest is 0.476.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Radiological Hallmark are significantly commonly distributed with a p-value = 1.
 
**A- Hallmark with Status:

```{r warning=FALSE, , echo=TRUE}

Hallmark_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Hallmark", add_dependent_label = T, cont_cut = 1))
Hallmark_status

Count_Hallmark1 <- table(HCC$Hallmark, HCC$Status)
Percent_Hallmark1 <- prop.table(Count_Hallmark1)*100

Hallmark_persent1 <- as.data.frame(cbind(Count_Hallmark1, Percent_Hallmark1))
Hallmark_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Hallmark, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hallmark, Status)

```

 p-value of chi.square is 0.3019 > 0.05. So, this means there is no evidence to suggest that Patients with Radiological Hallmark tends to have different Status.
 
**B- Hallmark with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Hallmark_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Hallmark", add_dependent_label = T,cont_cut = 1))
Hallmark_symptoms

Count_Hallmark2 <- table(HCC$Hallmark, HCC$Symptoms)
Percent_Hallmark2 <- prop.table(Count_Hallmark2)*100

Hallmark_persent2 <- as.data.frame(cbind(Count_Hallmark2, Percent_Hallmark2))
Hallmark_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Hallmark, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hallmark, Symptoms) 
```

 p-value of chi.square is 0.5479 > 0.05. So, this means there is no evidence to suggest that Patients with Radiological Hallmark tends to have different Symptoms Appearance.
 
**C- Hallmark with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Hallmark_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Hallmark", add_dependent_label = T, cont_cut = 1))
Hallmark_PS

Count_Hallmark3 <- table(HCC$Hallmark, HCC$PS)
Percent_Hallmark3 <- prop.table(Count_Hallmark3)*100

Hallmark_persent3 <- as.data.frame(cbind(Count_Hallmark3, Percent_Hallmark3))
Hallmark_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Hallmark, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hallmark, PS)
```

 p-value of chi.square is 0.00249 < 0.05. So, this means there is evidence to suggest that Patients with Radiological Hallmark tends to have different Performance Status.
 
**D- Hallmark with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Hallmark_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Hallmark", add_dependent_label = T, cont_cut = 1))
Hallmark_Stages 


Count_Hallmark4 <- table(HCC$Hallmark, HCC$HCC_Stages)
Percent_Hallmark4 <- prop.table(Count_Hallmark4)*100

Hallmark_persent4 <- as.data.frame(cbind(Count_Hallmark4, Percent_Hallmark4))
Hallmark_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Hallmark, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Hallmark, HCC_Stages)

```

 p-value of chi.square is 0.03873 < 0.05. So, this means there is evidence to suggest that Patients with Radiological Hallmark tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#7- Relation Between Encephalopathy and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Encephalopathy_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Encephalopathy, na.rm = T)))

Encephalopathy_sd

Count_Encephalopathy <- table(HCC$Encephalopathy)
Percent_Encephalopathy <- prop.table(Count_Encephalopathy)*100

Encephalopathy_persent <- as.data.frame(cbind(Count_Encephalopathy, Percent_Encephalopathy))
Encephalopathy_persent


ggplot(HCC,aes(Encephalopathy, fill= Encephalopathy)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Encephalopathy)

```

  SD of the Portal Vein Thrombosis population of Intrest is 0.659.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Encephalopathy are significantly commonly distributed with a p-value = 1.
 
**A- Encephalopathy with Status:

```{r warning=FALSE, , echo=TRUE}

Encephalopathy_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Encephalopathy", add_dependent_label = T, cont_cut = 1))
Encephalopathy_status

Count_Encephalopathy1 <- table(HCC$Encephalopathy, HCC$Status)
Percent_Encephalopathy1 <- prop.table(Count_Encephalopathy1)*100

Encephalopathy_persent1 <- as.data.frame(cbind(Count_Encephalopathy1, Percent_Encephalopathy1))
Encephalopathy_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Encephalopathy, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Encephalopathy, Status)

```

 p-value of chi.square is 0.02198 < 0.05. So, this means there is evidence to suggest that Patients with Encephalopathy tends to have different Status.
 
**B- Encephalopathy with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Encephalopathy_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Encephalopathy", add_dependent_label = T,cont_cut = 1))
Encephalopathy_symptoms

Count_Encephalopathy2 <- table(HCC$Encephalopathy, HCC$Symptoms)
Percent_Encephalopathy2 <- prop.table(Count_Encephalopathy2)*100

Encephalopathy_persent2 <- as.data.frame(cbind(Count_Encephalopathy2, Percent_Encephalopathy2))
Encephalopathy_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Encephalopathy, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Encephalopathy, Symptoms) 
```

 p-value of chi.square is 0.1957 > 0.05. So, this means there is no evidence to suggest that Patients with Encephalopathy tends to have different Symptoms Appearance.
 
**C- Encephalopathy with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Encephalopathy_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Encephalopathy", add_dependent_label = T, cont_cut = 1))
Encephalopathy_PS

Count_Encephalopathy3 <- table(HCC$Encephalopathy, HCC$PS)
Percent_Encephalopathy3 <- prop.table(Count_Encephalopathy3)*100

Encephalopathy_persent3 <- as.data.frame(cbind(Count_Encephalopathy3, Percent_Encephalopathy3))
Encephalopathy_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Encephalopathy, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Encephalopathy, PS)
```

 p-value of chi.square is 1.392e-15 < 0.05. So, this means there is evidence to suggest that Patients with Encephalopathy tends to have different Performance Status.
 
**D- Encephalopathy with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Encephalopathy_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Encephalopathy", add_dependent_label = T, cont_cut = 1))
Encephalopathy_Stages 


Count_Encephalopathy4 <- table(HCC$Encephalopathy, HCC$HCC_Stages)
Percent_Encephalopathy4 <- prop.table(Count_Encephalopathy4)*100

Encephalopathy_persent4 <- as.data.frame(cbind(Count_Encephalopathy4, Percent_Encephalopathy4))
Encephalopathy_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Encephalopathy, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Encephalopathy, HCC_Stages)

```

 p-value of chi.square is 3.786e-07 < 0.05. So, this means there is evidence to suggest that Patients with Encephalopathy tends to have different HCC Stages.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#8- Relation Between Ascites and Dependent Variables:
  
```{r warning=FALSE, , echo=TRUE}

Ascites_sd <- as.data.frame(HCC %>%
               summarise(count = n(), sd = sd(Ascites, na.rm = T)))

Ascites_sd

Count_Ascites <- table(HCC$Ascites)
Percent_Ascites <- prop.table(Count_Ascites)*100

Ascites_persent <- as.data.frame(cbind(Count_Ascites, Percent_Ascites))
Ascites_persent


ggplot(HCC,aes(Ascites, fill= Ascites)) +
  geom_bar(stat="count") +
  theme_economist()

chisq.test(Ascites)

```

  SD of the Portal Vein Thrombosis population of Intrest is 0.8419.

 The p-value of the test is 1, which is greater than the significance level alpha = 0.05. We can conclude that the Patients with Ascites are significantly commonly distributed with a p-value = 1.
 
**A- Ascites with Status:

```{r warning=FALSE, , echo=TRUE}

Ascites_status <- as.data.frame(HCC %>%
           summary_factorlist("Status", "Ascites", add_dependent_label = T, cont_cut = 1))
Ascites_status

Count_Ascites1 <- table(HCC$Ascites, HCC$Status)
Percent_Ascites1 <- prop.table(Count_Ascites1)*100

Ascites_persent1 <- as.data.frame(cbind(Count_Ascites1, Percent_Ascites1))
Ascites_persent1

ggplot(HCC,aes(Status, fill= Status)) +
  geom_bar(stat="count") +
  facet_wrap(~Ascites, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Ascites, Status)

```

 p-value of chi.square is 0.003268 < 0.05. So, this means there is evidence to suggest that Patients with Ascites tends to have different Status.
 
**B- Ascites with Symptoms:

```{r warning=FALSE, , echo=TRUE}

Ascites_symptoms <- as.data.frame(HCC %>%
                                     summary_factorlist("Symptoms", "Ascites", add_dependent_label = T,cont_cut = 1))
Ascites_symptoms

Count_Ascites2 <- table(HCC$Ascites, HCC$Symptoms)
Percent_Ascites2 <- prop.table(Count_Ascites2)*100

Ascites_persent2 <- as.data.frame(cbind(Count_Ascites2, Percent_Ascites2))
Ascites_persent2

ggplot(HCC,aes(Symptoms, fill= Symptoms)) +
  geom_bar(stat="count") +
  facet_wrap(~Ascites, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Ascites, Symptoms) 
```

 p-value of chi.square is 0.01866 < 0.05. So, this means there is evidence to suggest that Patients with Ascites tends to have different Symptoms Appearance.
 
**C- Ascites with Performance Status:

```{r warning=FALSE, , echo=TRUE}

Ascites_PS <- as.data.frame(HCC %>%
                 summary_factorlist("PS", "Ascites", add_dependent_label = T, cont_cut = 1))
Ascites_PS

Count_Ascites3 <- table(HCC$Ascites, HCC$PS)
Percent_Ascites3 <- prop.table(Count_Ascites3)*100

Ascites_persent3 <- as.data.frame(cbind(Count_Ascites3, Percent_Ascites3))
Ascites_persent3

ggplot(HCC,aes(PS, fill= PS)) +
  geom_bar(stat="count") +
  facet_wrap(~Ascites, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Ascites, PS)
```

 p-value of chi.square is 2.158e-07< 0.05. So, this means there is evidence to suggest that Patients with Ascites tends to have different Performance Status.
 
**D- Ascites with HCC Stage:

```{r warning=FALSE, , echo=TRUE}

Ascites_Stages <- as.data.frame(HCC %>%
     summary_factorlist("HCC_Stages", "Ascites", add_dependent_label = T, cont_cut = 1))
Ascites_Stages 


Count_Ascites4 <- table(HCC$Ascites, HCC$HCC_Stages)
Percent_Ascites4 <- prop.table(Count_Ascites4)*100

Ascites_persent4 <- as.data.frame(cbind(Count_Ascites4, Percent_Ascites4))
Ascites_persent4


ggplot(HCC,aes(HCC_Stages, fill= HCC_Stages)) +
  geom_bar(stat="count") +
  facet_wrap(~Ascites, ncol=2,scale="fixed") +
  scale_x_discrete(labels = abbreviate) +
  theme_economist() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.2))

chisq.test(Ascites, HCC_Stages)

```

 p-value of chi.square is 1.089e-08 < 0.05. So, this means there is evidence to suggest that Patients with Ascites tends to have different HCC Stages.

**********************************************************************************************************************************************************************************************************************************************************************************************

## Interpretation & Conclusion:

1- Parameters that have Significant Relation with Status of the Patients:
   Age, Endemic, INR, AFP, Hemoglobin, ALP, Direct Bilirubin, PVT, Encephlopathy, Leucocytes, Albumin, Total Bilirubin, GGT, AST, Creatinin, Ferritin, Metastasis and Ascites.

2- Parameters that have Significant Relation with HCC Symptoms Appearance:
   AFP, Hemoglobin, MCV, Platelets, ALP, Ferritin, AHT, HIV, Varices, Metastasis and Ascites.
   
3- Parameters that have Significant Relation with Patients Performance Status:
   Alcohol, Diabetes, INR, AFP, Hemoglobin, Albumin, Platelets, Bilirubin, ALP, TP, Creatinin, Direct Bilirubin, Ferritin, HBsAg, HBeAg, Varices, PHT, PVT, Metastasis, Radiological Hallmark, Ecephalopathy and Ascites.
   
4- Parameters that have Significant Relation with HCC Stages of Patients:
   Alcohol, Obesity, INR, AFP, Hemoglobin, MCV, Leucocytes, Albumin, Total Bilirubin, AST, ALP, TP, Direct Bilirubin, NASH, Splenomegaly, PHT, PVT, Metastasis, Radiological Hallmark, Encephalopathy and Ascites.
   
5- The rest of the paramenters can be excluded and dropped from our analysis.

**********************************************************************************************************************************************************************************************************************************************************************************************

###First: Parameters Affect Status of Patients:

```{r warning=FALSE, , echo=TRUE}

Status_regress <- glm(formula = Status ~ Age + Endemic + INR + AFP + Hemoglobin + ALP + Dir_Bil + PVT + Encephalopathy + Leucocytes + Albumin + Total_Bil + GGT + AST + Creatinine + Ferritin + Metastasis + Ascites, family = binomial, data = HCC)

summary(Status_regress)

```

# A- Significant p-value:

With Age, Endemic, ALP, PVT, Ferritin and Metastasis.

```{r warning=FALSE, , echo=TRUE}

Status_regress1 <- glm(formula = Status ~ Age + Endemic +  ALP +  PVT + Ferritin + Metastasis, family = binomial, data = HCC)

summary(Status_regress1)
Status_df <- tidy(Status_regress1)

Status_df %>%
  mutate(term=reorder(term,estimate)) %>%
  ggplot( aes(term,estimate, fill=estimate)) +
  geom_bar(stat="identity") +
  scale_fill_gradient(low="firebrick3", high="dodgerblue4") +
  theme_economist() +
  geom_hline(yintercept=0) +
  coord_flip()

```

** Plotting the Ceffecients:

1- Presence of patients in Endemic area, the probability of them living with HCC is increased.

2- The Presence of Metastasis, increase the probabilty of Deing with HCC.

3- The prescence of Portal Vein thrombosis, increase the probability of Deing.

4- Patients with HCC have increased Probability to Death.

#B- Correlation:

A dot representation was used where blue represents positive and red represent negative.

```{r warning=FALSE, , echo=TRUE}

Correlation_status <- cor(Original[ ,c(65, 39, 24, 56, 36, 64, 37)])
Correlation_status
corrplot(Correlation_status, method = "circle")


```

#C- Crude and Adjusted model:

```{r warning=FALSE, , echo=TRUE}

as.data.frame(printCrudeAndAdjustedModel(Status_regress1)[-1, ])
```

#Interpretation: 

1- Odds Ratio = 5.43 > Greater than 1.0 indicates that the odds of living in patients live in Endemic area are greater than the odds of living in Patients Live in Non Endemic area . 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (1.39 - 35.97) captured the Crude odds ratio.

2- Odds Ratio = 1 equal to 1.0, an odds ratio means that increase in Alkalin Phosphatase of Patients has Equal probability in the odds of Living patients.
So, There is 95% percent confident that this interval (0.99 - 1) captured the Crude odds ratio.

3- Odds Ratio = 0.97 < Less than 1.0, an odds ratio means that increase in Age of Patients leads to a 0.97 fold decrease in the odds of Living and died Patients with HCC.
So, There is 95% percent confident that this interval (0.95 - 0.99) captured the Crude odds ratio.

4- Odds Ratio = 0.41 < Less than 1.0 indicates that the odds of living in patients with portal vein thrombosis are less than the odds of living in Patients Live in patients without portal vein thrombosis . 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (0.20 - 0.82) captured the Crude odds ratio.

5- Odds Ratio = 1 equal to 1.0, an odds ratio means that increase in Ferritin level of Patients has Equal probability in the odds of Living and died patients with HCC.
So, There is 95% percent confident that this interval (1 - 1) captured the Crude odds ratio.

6- Odds Ratio = 0.28 < Less than 1.0 indicates that the odds of Living in patients with Metastasis are less than the odds of Living in patients without Metastasis, but is not a strong association.

So, There is 95% percent confident that this interval (0.14 - 0.55) captured the Crude odds ratio.

**********************************************************************************************************************************************************************************************************************************************************************************************

###Second: Parameters Affect Performance Status:

```{r warning=FALSE, , echo=TRUE}

PS_regress <- glm(formula = PS ~ Alcohol + Diabetes + INR + AFP + Hemoglobin + Albumin + Platelets + Total_Bil + ALP + TP + Creatinine + Dir_Bil + Ferritin + HBsAg + HBeAg + Varices + PHT + PVT + Metastasis + Hallmark + Encephalopathy + Ascites, family = binomial, data = HCC)

summary(PS_regress)

```

# A- Significant p-value:

With Ascites, Metastasis, Hemoglobin, PVT and Encephalopathy.

```{r warning=FALSE, , echo=TRUE}

PS_regress1 <- glm(formula = PS ~ Metastasis + Ascites + Hemoglobin + PVT + Encephalopathy, family = binomial, data = HCC)

summary(PS_regress1)
PS_df <- tidy(PS_regress1)

PS_df %>%
  mutate(term=reorder(term,estimate)) %>%
  ggplot( aes(term,estimate, fill=estimate)) +
  geom_bar(stat="identity") +
  scale_fill_gradient(low="firebrick3", high="dodgerblue4") +
  theme_economist() +
  geom_hline(yintercept=0) +
  coord_flip()

```

** Plotting the Ceffecients:

1- Patients with Encephalopathy Grade III/IV, increase the probabilty of affect Performance Status of Patients with HCC.

2- Metastatic Patients, increase the probabilty of affect Performance Status of Patients with HCC.

3- If the Patients with Moderate to Sever Ascites, increase the probabilty of affect Performance Status in Patients with HCC.

4- If the Patients with Portal Vein Thrombosis, increase the probabilty of affect Performance Status in Patients with HCC.

5- The Absence of Ascites, decrease the probabilty of affect Performance Status in Patients with HCC.

6- The Absence of Encephalopathy, decrease the probabilty of affect Performance Status in Patients with HCC.

#B- Correlation:

A dot representation was used where blue represents positive and red represent negative.

```{r warning=FALSE, , echo=TRUE}

Correlation_PS <- cor(Original[ ,c(47, 36, 37, 43, 44)])
Correlation_PS
corrplot(Correlation_PS, method = "circle")


```

#C- Crude and Adjusted model:

```{r warning=FALSE, , echo=TRUE}

as.data.frame(printCrudeAndAdjustedModel(PS_regress1)[-1, ])
```

#Interpretation: 

1- Odds Ratio = 7.07 > Greater than 1.0 indicates that the odds of change in Performance Status in Presence of Metastasis are greater than the odds of change in Performance Status with absence Metastasis. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (3.17 - 18.07) captured the Crude odds ratio.

2- Odds Ratio = 2.15 > Greater than 1.0 indicates that the odds of change in Performance Status in Presence of Moderate to Sever Ascites are greater than the odds of change in Performance Status in absence of Moderate to Sever Ascites. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (0.48 - 15.14) captured the Crude odds ratio.

3- Odds Ratio = 1422850.98 > Greater than 1.0 indicates that the odds of change in Performance Status in Presence of Grade III/IV Encephalopathy are greater than the odds of change in Performance Status in other Encephalopathy Stages. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (0.00 - 3.24e+153) captured the Crude odds ratio.

4- Odds Ratio = 5.64 > Greater than 1.0 indicates that the odds of change in Performance Status in Presence of Portal Vein Thrombosis are greater than the odds of change in Performance Status in absence of Portal Vein Thrombosis. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (2.51 - 14.47) captured the Crude odds ratio.

5- Odds Ratio = 0.67 < Less than 1.0, an odds ratio means that increase in Hemoglobin of Patients leads to a 0.67 fold decrease in the odds of change in Performance Status in Patients with HCC.
So, There is 95% percent confident that this interval (0.57 - 0.79) captured the Crude odds ratio.

6- Odds Ratio = 0.15 < Less than 1.0, indicates that the odds of change in Performance Status in Absence of Ascites are less than the odds of change in Performance Status in presence of Ascites. 
The magnitude of the odds ratio suggests a weak association.
So, There is 95% percent confident that this interval (0.06 - 0.32) captured the Crude odds ratio.


**********************************************************************************************************************************************************************************************************************************************************************************************

###Third: Parameters Affect Symptoms Appearance:

```{r warning=FALSE, , echo=TRUE}

Symptoms_regress <- glm(formula = Symptoms ~ AFP + Hemoglobin + MCV + Platelets + ALP + Ferritin + AHT + HIV + Varices + Metastasis + Ascites, family = binomial, data = HCC)

summary(Symptoms_regress)

```

# A- Significant p-value:

With Ascites and Metastasis.

```{r warning=FALSE, , echo=TRUE}

Symptoms_regress1 <- glm(formula = Symptoms ~ Metastasis + Ascites, family = binomial, data = HCC)

summary(Symptoms_regress1)
Symptoms_df <- tidy(Symptoms_regress1)

Symptoms_df %>%
  mutate(term=reorder(term,estimate)) %>%
  ggplot( aes(term,estimate, fill=estimate)) +
  geom_bar(stat="identity") +
  scale_fill_gradient(low="firebrick3", high="dodgerblue4") +
  theme_economist() +
  geom_hline(yintercept=0) +
  coord_flip()

```

** Plotting the Ceffecients:

1- If Patients with no Ascites, the probability of them Symptoms Appearance with HCC is Decreased.

the presence of Moderate to sever Ascites, the probability of Symptoms appearance increased.

2- The Presence of Metastasis, increase the probabilty of Symptoms appearance with HCC.

#B- Correlation:

A dot representation was used where blue represents positive and red represent negative.

```{r warning=FALSE, , echo=TRUE}

Correlation_symptoms <- cor(Original[ ,c(17, 37, 44)])
Correlation_symptoms
corrplot(Correlation_symptoms, method = "circle")


```

#C- Crude and Adjusted model:

```{r warning=FALSE, , echo=TRUE}

as.data.frame(printCrudeAndAdjustedModel(Symptoms_regress1)[-1, ])
```

#Interpretation: 

1- Odds Ratio = 4.45 > Greater than 1.0 indicates that the odds of Symptoms Appearance in Patients with Metastasis are greater than the odds of No Symptoms Appearance in Patients with Metastasis. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (1.91 - 12.22) captured the Crude odds ratio.

2- Odds Ratio = 3.6 > Greater than 1.0 indicates that the odds of Symptoms Appearance in Patients with Moderate to Sever Ascites are greater than the odds of No Symptoms Appearance in Patients with Moderate to Sever Ascites. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (0.87 - 24.61) captured the Crude odds ratio.

3- Odds Ratio = 0.59 < Less than 1.0, indicates that the odds of Symptoms Appearance in Patients without Ascites are less than the odds of No Symptoms Appearance in Patients without Ascites. 
So, There is 95% percent confident that this interval (0.27 - 1.23) captured the Crude odds ratio.

**********************************************************************************************************************************************************************************************************************************************************************************************

###Fourth: Parameters Affect HCC Stages:

```{r warning=FALSE, , echo=TRUE}

Stages_regress <- glm(formula = HCC_Stages ~ Alcohol + Obesity + INR + AFP + Hemoglobin + MCV + Leucocytes + Albumin + Total_Bil + AST + ALP + TP + Dir_Bil + NASH + Spleno + PHT + PVT + Metastasis + Hallmark + Encephalopathy + Ascites, family = binomial, data = HCC)

summary(Stages_regress)

```

# A- Significant p-value:

With INR, Leucocytes, PVT, Encephalopathy and Metastasis.

```{r warning=FALSE, , echo=TRUE}

Stages_regress1 <- glm(formula = HCC_Stages ~ INR + Leucocytes + PVT + Metastasis + Encephalopathy, family = binomial, data = HCC)

summary(Stages_regress1)
Stages_df <- tidy(Stages_regress1)

Stages_df %>%
  mutate(term=reorder(term,estimate)) %>%
  ggplot( aes(term,estimate, fill=estimate)) +
  geom_bar(stat="identity") +
  scale_fill_gradient(low="firebrick3", high="dodgerblue4") +
  theme_economist() +
  geom_hline(yintercept=0) +
  coord_flip()

```

** Plotting the Ceffecients:

1- If Patients with no Encephalopathy, the probability of change in HCC Stages with HCC is Decreased.

2- If Patients with  Portal Vein thrombosis, the probability of change in HCC Stages with HCC is Decreased.

3- The Presence of Metastasis, decrease the probabilty of change in HCC Stages with HCC.

4- If change in INR, the probability of change in HCC Stages with HCC is Increased.

#B- Correlation:

A dot representation was used where blue represents positive and red represent negative.

```{r warning=FALSE, , echo=TRUE}

Correlation_Stages <- cor(Original[ ,c(45, 49, 36, 37, 43)])
Correlation_Stages
corrplot(Correlation_Stages, method = "circle")


```

#C- Crude and Adjusted model:

```{r warning=FALSE, , echo=TRUE}

as.data.frame(printCrudeAndAdjustedModel(Stages_regress1)[-1, ])
```

#Interpretation:

1- Odds Ratio = 1.61 > greater than 1.0, an odds ratio means that increase in INR values in Patients leads to a 1.61 fold increase in the odds of change in HCC Stages in Patients with HCC.
So, There is 95% percent confident that this interval (0.76 - 4.18) captured the Crude odds ratio.

2- Odds Ratio = 1  equal to 1.0, an odds ratio means that increase in Leucocytes values in Patients has equal probability in the odds of change in HCC Stages in Patients with HCC.
So, There is 95% percent confident that this interval (1 - 1) captured the Crude odds ratio.

3- Odds Ratio = 1043424.05 > Greater than 1.0 indicates that the odds of change in HCC Stages in Patients with Grade III/IV Encephalopathy are greater than the odds of change in HCC Stages in Patients with absence Encephalopathy. 
The magnitude of the odds ratio suggests a strong association.
So, There is 95% percent confident that this interval (0 - 8.76e+206) captured the Crude odds ratio.

4- Odds Ratio = 0.16 < Less than 1.0, indicates that the odds of change in HCC Stages in Patients with Portal vein thrombosis are less than the odds of of change in HCC Stages in Patients without Portal vein thrombosis. 
So, There is 95% percent confident that this interval (0.07 - 0.36) captured the Crude odds ratio.

5- Odds Ratio = 0.09 < Less than 1.0, indicates that the odds of change in HCC Stages in Patients with Metastasis are less than the odds of of change in HCC Stages in Patients without Metastasis. 
So, There is 95% percent confident that this interval (0.04 - 0.2) captured the Crude odds ratio.

6- Odds Ratio = 0.11 < Less than 1.0, indicates that the odds of change in HCC Stages in Patients with absence Encephalopathy are less than the odds of of change in HCC Stages in Patients with different stages of Encephalopathy. 
So, There is 95% percent confident that this interval (0.01 - 0.58) captured the Crude odds ratio.

****************************************************************************************************************************************************************************************************************************************************





